nohup: ignoring input
INFO:__main__:Loading rules...
INFO:rule_loader:Found 171 rule files
INFO:rule_loader:Successfully loaded 171 rules
INFO:__main__:Loaded 171 rules
INFO:__main__:Starting SIEM Dashboard on 0.0.0.0:1212
 * Serving Flask app 'app'
 * Debug mode: on
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:1212
 * Running on http://10.174.195.238:1212
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug: * Restarting with stat
INFO:__main__:Loading rules...
INFO:rule_loader:Found 171 rule files
INFO:rule_loader:Successfully loaded 171 rules
INFO:__main__:Loaded 171 rules
INFO:__main__:Starting SIEM Dashboard on 0.0.0.0:1212
WARNING:werkzeug: * Debugger is active!
INFO:werkzeug: * Debugger PIN: 118-116-365
INFO:rule_engine:Found 171 enabled rules out of 171 total
INFO:rule_engine:Starting execution of 171 rules
INFO:rule_engine:Executing rule: Imtiyozli guruhga foydalanuvchi qo'shilishi
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code IN ("4728", "4732", "4756") // Guruhga foydalanuvchi qo'shish k...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.867s]
/home/mikro/All-ESQL-standart-rules/es_client.py:52: ElasticsearchWarning: No limit defined, adding default limit of [1000]
  response = self.client.esql.query(
INFO:rule_engine:Executing rule: Brute-force, Password Spraying va NTLM Relay tahlili
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code IN ("4624", "4625")
| EVAL 
    is_fail = CASE(event.code == "4...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.287s]
INFO:alert_manager:Added alert: alert_1 - Brute-force, Password Spraying va NTLM Relay tahlili
INFO:rule_engine:Generated alert for rule 'Brute-force, Password Spraying va NTLM Relay tahlili' with 1 matched logs
INFO:rule_engine:Executing rule: PrintSpooler orqali imtiyozlarni oshirish (Privilege Escalation)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*
| WHERE winlog.event_data.ParentProcessName == "spoolsv.exe" 
  AND N...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.102s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 6:85: Unknown column [winlog.event_data.CommandLine], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, winlog.event_data.ParentProcessName, winlog.event_data.NewProcessName.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*
| WHERE winlog.event_data.ParentProcessName == "spoolsv.exe" 
  AND NOT winlog.event_data.NewProcessName IN ("conhost.exe", "WerFault.exe")
| STATS 
    count() 
  BY host.name, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, winlog.event_data.CommandLine, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: PrintSpooler orqali imtiyozlarni oshirish (Privilege Escalation)
INFO:rule_engine:Executing rule: LSASS xotirasi dump qilinishi (Credential Dumping)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code == "10" // Sysmon: ProcessAccess
  AND winlog.event_data.Target...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:7: Unknown column [winlog.event_data.TargetImage], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, winlog.event_data.TargetUserName.keyword, winlog.event_data.NewProcessName.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*
| WHERE event.code == "10" // Sysmon: ProcessAccess
  AND winlog.event_data.TargetImage == "lsass.exe"
  AND NOT winlog.event_data.NewProcessName IN ("msmpeng.exe", "svchost.exe", "searchindexer.exe")
| STATS 
    access_count = COUNT(*) 
  BY host.name, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: LSASS xotirasi dump qilinishi (Credential Dumping)
INFO:rule_engine:Executing rule: Kritik AD guruhlari a'zoligi o'zgarishi (Ultimate Monitoring)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code IN ("4728", "4732", "4756")
  AND (
    winlog.event_data.Group...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.204s]
INFO:rule_engine:Executing rule: AdminSDHolder ob'ekti manipulyatsiyasi
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code == "5136"
  AND winlog.event_data.TargetUserName LIKE "*CN=Admi...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.203s]
/home/mikro/All-ESQL-standart-rules/es_client.py:52: ElasticsearchWarning: Line 6:17: Field 'winlog.event_data.TargetUserName' shadowed by field at line 6:51
  response = self.client.esql.query(
INFO:rule_engine:Executing rule: Mukammal DCSync xuruji aniqlanishi (AD Hash Dumping)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code == "4662" 
  AND (
    winlog.event_data.TargetUserName LIKE "*...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.202s]
INFO:rule_engine:Executing rule: Shubhali Group Policy (GPO) o'zgarishi
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code IN ("5136", "5137") // Directory Service object was modified/cr...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.204s]
/home/mikro/All-ESQL-standart-rules/es_client.py:52: ElasticsearchWarning: Line 9:17: Field 'winlog.event_data.TargetUserName' shadowed by field at line 9:51
  response = self.client.esql.query(
INFO:rule_engine:Executing rule: AD Kerberos Delegation (Ishonchnoma) o'zgarishi
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code == "4738" OR event.code == "4742" // User or Computer account c...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.203s]
INFO:rule_engine:Executing rule: AD Ob'ektlarining SID History maydoni o'zgarishi
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code == "4738" // A user account was changed
  AND winlog.event_data...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.203s]
/home/mikro/All-ESQL-standart-rules/es_client.py:52: ElasticsearchWarning: Line 7:17: Field 'winlog.event_data.TargetUserName' shadowed by field at line 7:51
  response = self.client.esql.query(
INFO:rule_engine:Executing rule: Audit xavfsizlik siyosatining o'zgartirilishi
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*
| WHERE (winlog.event_data.NewProcessName == "auditpol.exe" AND (winl...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.207s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 2:66: Unknown column [winlog.event_data.CommandLine], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, winlog.event_data.NewProcessName.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*
| WHERE (winlog.event_data.NewProcessName == "auditpol.exe" AND (winlog.event_data.CommandLine LIKE "*/set*" OR winlog.event_data.CommandLine LIKE "*/remove*"))
  OR event.code == "4719" // System audit policy was changed
| STATS 
    change_count = COUNT(*) 
  BY host.name, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, winlog.event_data.CommandLine, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Audit xavfsizlik siyosatining o'zgartirilishi
INFO:rule_engine:Executing rule: Audit fayllariga ruxsatsiz kirish urinishi
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*
| WHERE (winlog.event_data.TargetFilename LIKE "*.evtx" OR winlog.eve...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.054s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 2:10: Unknown column [winlog.event_data.TargetFilename], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword, winlog.event_data.NewProcessName, winlog.event_data.NewProcessName.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*
| WHERE (winlog.event_data.TargetFilename LIKE "*.evtx" OR winlog.event_data.TargetFilename LIKE "/var/log/*")
  AND winlog.event_data.NewProcessName IN ("cmd.exe", "powershell.exe", "python.exe", "python", "sh", "bash", "curl", "wget")
  AND event.type IN ("access", "read")
| STATS 
    access_count = COUNT(*) 
  BY host.name, winlog.event_data.TargetUserName, winlog.event_data.TargetFilename, winlog.event_data.NewProcessName, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Audit fayllariga ruxsatsiz kirish urinishi
INFO:rule_engine:Executing rule: Audit loglarining o'chirilishini aniqlash
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*
| WHERE event.code == "1102"                                   // Win...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:2.809s]
/home/mikro/All-ESQL-standart-rules/es_client.py:52: ElasticsearchWarning: Line 3:7: evaluation of [event.action] failed, treating result as null. Only first 20 failures recorded.
  response = self.client.esql.query(
/home/mikro/All-ESQL-standart-rules/es_client.py:52: ElasticsearchWarning: Line 3:7: java.lang.IllegalArgumentException: single-value function encountered multi-value
  response = self.client.esql.query(
INFO:rule_engine:Executing rule: Event Log xizmatining shubhali to'xtashi yoki xatoligi
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE winlog.channel == "System"
  AND (
    (event.code == "7036" AND message L...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.201s]
INFO:rule_engine:Executing rule: Linux Audit konfiguratsiyasining o'zgartirilishi
INFO:es_client:Executing ES|QL query: FROM auditbeat-*
| WHERE winlog.event_data.TargetFilename IN ("/etc/audit/audit.rules", "/etc/audit/...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.032s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 2:9: Unknown column [winlog.event_data.TargetFilename]\nline 4:11: Unknown column [winlog.event_data.TargetUserName]')
ERROR:es_client:Query: FROM auditbeat-*
| WHERE winlog.event_data.TargetFilename IN ("/etc/audit/audit.rules", "/etc/audit/auditd.conf", "/etc/audit/rules.d/*")
  AND event.type IN ("change", "deletion", "creation")
  AND NOT winlog.event_data.TargetUserName == "root"
| STATS 
    mod_count = COUNT(*) 
  BY host.name, winlog.event_data.TargetUserName, winlog.event_data.TargetFilename, winlog.event_data.NewProcessName, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Linux Audit konfiguratsiyasining o'zgartirilishi
INFO:rule_engine:Executing rule: Ruxsatsiz dasturiy ta'minot o'rnatilishi
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*
| WHERE (winlog.event_data.NewProcessName == "msiexec.exe" AND winlog...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.173s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 2:64: Unknown column [winlog.event_data.CommandLine], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, winlog.event_data.NewProcessName.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*
| WHERE (winlog.event_data.NewProcessName == "msiexec.exe" AND winlog.event_data.CommandLine LIKE "*/i*")
  OR (event.code == "11" AND winlog.channel == "Application" AND message LIKE "*MsiInstaller*")
| STATS 
    install_command = MAX(winlog.event_data.CommandLine),
    package_name = MAX(winlog.event_data.PackageName),
    event_count = COUNT(*)
  BY host.name, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Ruxsatsiz dasturiy ta'minot o'rnatilishi
INFO:rule_engine:Executing rule: Yangi Windows servisining yaratilishi (Persistence)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code == "7045" // A new service was installed in the system
  OR (ev...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.204s]
INFO:alert_manager:Added alert: alert_2 - Yangi Windows servisining yaratilishi (Persistence)
INFO:rule_engine:Generated alert for rule 'Yangi Windows servisining yaratilishi (Persistence)' with 6 matched logs
INFO:rule_engine:Executing rule: Ruxsatsiz portlarning ochilishi (Port Binding)
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, winlogbeat-*
| WHERE event.type == "start" OR event.code == "3" // Tarmoq ulanishi...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.203s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [winlog.event_data.DestPort], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, winlog.event_data.NewProcessName.keyword, winlog.event_data.TargetUserName.keyword]?')
ERROR:es_client:Query: FROM auditbeat-*, winlogbeat-*
| WHERE event.type == "start" OR event.code == "3" // Tarmoq ulanishi yoki xizmat boshlanishi
| WHERE winlog.event_data.DestPort IN (21, 22, 23, 445, 3389, 1433, 3306, 5432, 8080)
  AND NOT winlog.event_data.TargetUserName IN ("root", "SYSTEM", "network service", "LocalService")
| STATS 
    process_info = MAX(winlog.event_data.CommandLine),
    event_count = COUNT(*) 
  BY host.name, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Ruxsatsiz portlarning ochilishi (Port Binding)
INFO:rule_engine:Executing rule: Oddiy foydalanuvchilar tomonidan ma'muriy asboblar ishlatilishi
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*
| WHERE winlog.event_data.NewProcessName IN ("regedit.exe", "mmc.exe"...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.203s]
INFO:rule_engine:Executing rule: Yangi tarmoq interfeysi yoki USB qurilma qo'shilishi
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE winlog.channel == "System"
  AND (
    (event.code == "20001" AND message ...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.207s]
INFO:rule_engine:Executing rule: MFA (Ko'p faktorli autentifikatsiya) aylanib o'tilishini aniqlash
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE event.category == "authentication" ...
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:07:45] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:07:45] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:07:45] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:07:45] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:07:45] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:07:45] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.484s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:07:45] "GET /api/stats HTTP/1.1" 200 -
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:N/A duration:30.091s]
WARNING:elastic_transport.node_pool:Node <Urllib3HttpNode(http://139.28.47.17:9908)> has failed for 1 times in a row, putting on 1 second timeout
WARNING:elastic_transport.transport:Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connection.py", line 571, in getresponse
    httplib_response = super().getresponse()
  File "/usr/lib/python3.14/http/client.py", line 1450, in getresponse
    response.begin()
    ~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.14/http/client.py", line 336, in begin
    version, status, reason = self._read_status()
                              ~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.14/http/client.py", line 297, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/usr/lib/python3.14/socket.py", line 725, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
TimeoutError: timed out

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
        method,
    ...<4 lines>...
        **kw,  # type: ignore[arg-type]
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/util/retry.py", line 465, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 536, in _make_request
    self._raise_timeout(err=e, url=url, timeout_value=read_timeout)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 367, in _raise_timeout
    raise ReadTimeoutError(
        self, url, f"Read timed out. (read timeout={timeout_value})"
    ) from err
urllib3.exceptions.ReadTimeoutError: HTTPConnectionPool(host='139.28.47.17', port=9908): Read timed out. (read timeout=30)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/elastic_transport/_transport.py", line 344, in perform_request
    resp = node.perform_request(
        method,
    ...<3 lines>...
        request_timeout=request_timeout,
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionTimeout: Connection timeout caused by: ReadTimeoutError(HTTPConnectionPool(host='139.28.47.17', port=9908): Read timed out. (read timeout=30))
INFO:elastic_transport.node_pool:Resurrected node <Urllib3HttpNode(http://139.28.47.17:9908)> (force=False)
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:08:15] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:08:15] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:08:15] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:08:15] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:08:15] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:08:15] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.177s]
WARNING:elastic_transport.node_pool:Node <Urllib3HttpNode(http://139.28.47.17:9908)> has been marked alive after a successful request
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:08:15] "GET /api/stats HTTP/1.1" 200 -
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:N/A duration:31.991s]
WARNING:elastic_transport.node_pool:Node <Urllib3HttpNode(http://139.28.47.17:9908)> has failed for 1 times in a row, putting on 1 second timeout
WARNING:elastic_transport.transport:Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connection.py", line 571, in getresponse
    httplib_response = super().getresponse()
  File "/usr/lib/python3.14/http/client.py", line 1450, in getresponse
    response.begin()
    ~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.14/http/client.py", line 336, in begin
    version, status, reason = self._read_status()
                              ~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.14/http/client.py", line 297, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/usr/lib/python3.14/socket.py", line 725, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
TimeoutError: timed out

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
        method,
    ...<4 lines>...
        **kw,  # type: ignore[arg-type]
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/util/retry.py", line 465, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 536, in _make_request
    self._raise_timeout(err=e, url=url, timeout_value=read_timeout)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 367, in _raise_timeout
    raise ReadTimeoutError(
        self, url, f"Read timed out. (read timeout={timeout_value})"
    ) from err
urllib3.exceptions.ReadTimeoutError: HTTPConnectionPool(host='139.28.47.17', port=9908): Read timed out. (read timeout=30)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/elastic_transport/_transport.py", line 344, in perform_request
    resp = node.perform_request(
        method,
    ...<3 lines>...
        request_timeout=request_timeout,
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionTimeout: Connection timeout caused by: ReadTimeoutError(HTTPConnectionPool(host='139.28.47.17', port=9908): Read timed out. (read timeout=30))
INFO:elastic_transport.node_pool:Resurrected node <Urllib3HttpNode(http://139.28.47.17:9908)> (force=False)
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:08:45] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:08:45] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:08:45] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:08:45] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:08:45] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:08:45] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.259s]
WARNING:elastic_transport.node_pool:Node <Urllib3HttpNode(http://139.28.47.17:9908)> has been marked alive after a successful request
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:08:45] "GET /api/stats HTTP/1.1" 200 -
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:N/A duration:30.110s]
WARNING:elastic_transport.node_pool:Node <Urllib3HttpNode(http://139.28.47.17:9908)> has failed for 1 times in a row, putting on 1 second timeout
WARNING:elastic_transport.transport:Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connection.py", line 571, in getresponse
    httplib_response = super().getresponse()
  File "/usr/lib/python3.14/http/client.py", line 1450, in getresponse
    response.begin()
    ~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.14/http/client.py", line 336, in begin
    version, status, reason = self._read_status()
                              ~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.14/http/client.py", line 297, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/usr/lib/python3.14/socket.py", line 725, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
TimeoutError: timed out

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
        method,
    ...<4 lines>...
        **kw,  # type: ignore[arg-type]
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/util/retry.py", line 465, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 536, in _make_request
    self._raise_timeout(err=e, url=url, timeout_value=read_timeout)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 367, in _raise_timeout
    raise ReadTimeoutError(
        self, url, f"Read timed out. (read timeout={timeout_value})"
    ) from err
urllib3.exceptions.ReadTimeoutError: HTTPConnectionPool(host='139.28.47.17', port=9908): Read timed out. (read timeout=30)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/elastic_transport/_transport.py", line 344, in perform_request
    resp = node.perform_request(
        method,
    ...<3 lines>...
        request_timeout=request_timeout,
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionTimeout: Connection timeout caused by: ReadTimeoutError(HTTPConnectionPool(host='139.28.47.17', port=9908): Read timed out. (read timeout=30))
INFO:elastic_transport.node_pool:Resurrected node <Urllib3HttpNode(http://139.28.47.17:9908)> (force=False)
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:09:15] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:09:15] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:09:15] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:09:15] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:09:15] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:09:15] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.367s]
WARNING:elastic_transport.node_pool:Node <Urllib3HttpNode(http://139.28.47.17:9908)> has been marked alive after a successful request
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:09:15] "GET /api/stats HTTP/1.1" 200 -
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:N/A duration:38.760s]
WARNING:elastic_transport.node_pool:Node <Urllib3HttpNode(http://139.28.47.17:9908)> has failed for 1 times in a row, putting on 1 second timeout
ERROR:es_client:Error executing ES|QL query: Connection timeout caused by: ConnectionTimeout(Connection timeout caused by: ReadTimeoutError(HTTPConnectionPool(host='139.28.47.17', port=9908): Read timed out. (read timeout=30)))
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE event.category == "authentication" 
  AND event.outcome == "success"
  AND (
    // Cloud provayderlar uchun MFA holatini message scan orqali tekshirish
    message LIKE "*mfa*notApplied*" 
    OR message LIKE "*mfa*None*" 
    OR message LIKE "*mfa*missing*"
  )
| STATS 
    logon_count = COUNT(*), 
    last_logon = MAX(@timestamp) 
  BY winlog.event_data.TargetUserName, winlog.event_data.IpAddress, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: MFA (Ko'p faktorli autentifikatsiya) aylanib o'tilishini aniqlash
INFO:rule_engine:Executing rule: AS-REP Roasting hujumi aniqlanishi
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code == "4768" // A Kerberos authentication ticket (TGT) was request...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.721s]
WARNING:elastic_transport.node_pool:Node <Urllib3HttpNode(http://139.28.47.17:9908)> has been marked alive after a successful request
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:7: Unknown column [winlog.event_data.PreAuthType], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.Status, winlog.event_data.IpAddress, winlog.event_data.Status.keyword, winlog.event_data.IpAddress.keyword, winlog.event_data.TargetUserName.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*
| WHERE event.code == "4768" // A Kerberos authentication ticket (TGT) was requested
  AND winlog.event_data.PreAuthType == "0" // Pre-authentication not required
  AND winlog.event_data.Status == "0x0"   // Successful request
  AND NOT winlog.event_data.TargetUserName LIKE "*$"             // Kompyuter akkaunti emas
| STATS 
    attempt_count = COUNT(*) 
  BY winlog.event_data.IpAddress, winlog.event_data.TargetUserName, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: AS-REP Roasting hujumi aniqlanishi
INFO:rule_engine:Executing rule: Umumiy yoki sukut bo'yicha (Default) akkauntlar faolligi
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code == "4624"
  AND (winlog.event_data.TargetUserName == "Guest" OR...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.204s]
INFO:rule_engine:Executing rule: Kerberoasting hujumi aniqlanishi
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code == "4769" // A Kerberos service ticket was requested
  AND (win...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.104s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 3:8: Unknown column [winlog.event_data.TicketEncryptionType], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword, winlog.event_data.IpAddress.keyword, winlog.event_data.IpAddress]?\nline 3:60: Unknown column [winlog.event_data.TicketOptions], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.IpAddress, winlog.event_data.IpAddress.keyword, winlog.event_data.TargetUserName.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*
| WHERE event.code == "4769" // A Kerberos service ticket was requested
  AND (winlog.event_data.TicketEncryptionType == "0x17" OR winlog.event_data.TicketOptions LIKE "*0x40810000*") // RC4 encryption or specific options
  AND NOT winlog.event_data.TargetUserName LIKE "*$"
| STATS 
    ticket_count = COUNT(*) 
  BY winlog.event_data.TargetUserName, winlog.event_data.IpAddress, @timestamp
| WHERE ticket_count > 10 // Qisqa vaqtda ko'p bilet so'ralishi
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Kerberoasting hujumi aniqlanishi
INFO:rule_engine:Executing rule: Servis akkauntlarining interaktiv kirishi (Interactive Logon)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code == "4624" 
  AND winlog.event_data.LogonType IN ("2", "10") // ...
INFO:elastic_transport.node_pool:Resurrected node <Urllib3HttpNode(http://139.28.47.17:9908)> (force=False)
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.099s]
INFO:rule_engine:Executing rule: O'g'irlangan hisob ma'lumotlaridan foydalanish (Impossible Travel)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE event.category == "authentication" ...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.203s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:7: Unknown column [source.geo.country_name]')
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE event.category == "authentication" AND event.outcome == "success"
  AND source.geo.country_name IS NOT NULL
| STATS 
    country_count = COUNT_DISTINCT(source.geo.country_name),
    last_logon = MAX(@timestamp)
  BY winlog.event_data.TargetUserName
| WHERE country_count > 1
| SORT last_logon DESC
ERROR:rule_engine:Query execution failed for rule: O'g'irlangan hisob ma'lumotlaridan foydalanish (Impossible Travel)
INFO:rule_engine:Executing rule: Boshqa foydalanuvchining parolini o'zgartirishga urinish
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code == "4724" // An attempt was made to reset an account's password...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.200s]
/home/mikro/All-ESQL-standart-rules/es_client.py:52: ElasticsearchWarning: Line 7:6: Field 'winlog.event_data.TargetUserName' shadowed by field at line 7:40
  response = self.client.esql.query(
INFO:rule_engine:Executing rule: Shubhali ochiq matnli (Cleartext) autentifikatsiya protokollari
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE winlog.event_data.Protocol IN ("tel...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.208s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 2:9: Unknown column [winlog.event_data.Protocol], did you mean any of [winlog.event_data.IpAddress, winlog.event_data.IpAddress.keyword]?\nline 3:6: Unknown column [winlog.event_data.DestPort], did you mean any of [winlog.event_data.IpAddress, winlog.event_data.IpAddress.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE winlog.event_data.Protocol IN ("telnet", "ftp", "http") 
  OR winlog.event_data.DestPort IN (21, 23, 80)
| STATS 
    usage_count = COUNT(*) 
  BY winlog.event_data.IpAddress, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Shubhali ochiq matnli (Cleartext) autentifikatsiya protokollari
INFO:rule_engine:Executing rule: Host faolligining keskin ortishi (Anomaly Spike)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*,auditbeat-*
| STATS 
    log_count = COUNT(*) 
  BY host.name, @timestamp
| WHERE ...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:2.691s]
INFO:rule_engine:Executing rule: Linux masofaviy kirish anomaliyalari (SSH/Telnet)
INFO:es_client:Executing ES|QL query: FROM auditbeat-*
| WHERE event.action == "logged-in"
  AND (winlog.event_data.Protocol IN ("ssh", "t...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.790s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 3:8: Unknown column [winlog.event_data.Protocol]\nline 3:59: Unknown column [winlog.event_data.NewProcessName]')
ERROR:es_client:Query: FROM auditbeat-*
| WHERE event.action == "logged-in"
  AND (winlog.event_data.Protocol IN ("ssh", "telnet") OR winlog.event_data.NewProcessName IN ("sshd", "in.telnetd"))
| STATS 
    logon_count = COUNT(*) 
  BY host.name, winlog.event_data.TargetUserName, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Linux masofaviy kirish anomaliyalari (SSH/Telnet)
INFO:rule_engine:Executing rule: RDP orqali Lateral Movement harakatlari (Logon Type 10)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code == "4624" 
  AND winlog.event_data.LogonType == "10" // Remote ...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.099s]
INFO:rule_engine:Executing rule: WinRM orqali shubhali masofaviy boshqaruv
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE winlog.event_data.NewProcessName == "wsmprovhost.exe" 
  OR (event.code ==...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.101s]
INFO:rule_engine:Executing rule: SMB orqali Lateral Movement (Psexec/WMI)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code == "4688"
  AND (
    winlog.event_data.NewProcessName IN ("PsE...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.202s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 10:85: Unknown column [winlog.event_data.CommandLine], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, winlog.event_data.ParentProcessName, winlog.event_data.NewProcessName.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*
| WHERE event.code == "4688"
  AND (
    winlog.event_data.NewProcessName IN ("PsExec.exe", "PsExec64.exe") 
    OR (winlog.event_data.ParentProcessName == "services.exe" AND winlog.event_data.NewProcessName == "cmd.exe") // Psexec remote execution pattern
    OR (winlog.event_data.ParentProcessName == "wmiprvse.exe" AND winlog.event_data.NewProcessName IN ("cmd.exe", "powershell.exe")) // WMI remote execution
  )
| STATS 
    execution_count = COUNT(*) 
  BY host.name, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, winlog.event_data.CommandLine, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: SMB orqali Lateral Movement (Psexec/WMI)
INFO:rule_engine:Executing rule: Linux GTFOBins suiiste'moli orqali imtiyozlarni oshirish
INFO:es_client:Executing ES|QL query: FROM auditbeat-*
| WHERE (winlog.event_data.NewProcessName == "find" AND winlog.event_data.CommandLi...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.205s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 2:10: Unknown column [winlog.event_data.NewProcessName]\nline 2:57: Unknown column [winlog.event_data.CommandLine]')
ERROR:es_client:Query: FROM auditbeat-*
| WHERE (winlog.event_data.NewProcessName == "find" AND winlog.event_data.CommandLine LIKE "*-exec*")
  OR (winlog.event_data.NewProcessName == "vim" AND winlog.event_data.CommandLine LIKE "*-c*")
  OR (winlog.event_data.NewProcessName == "perl" AND winlog.event_data.CommandLine LIKE "*-e*")
  OR (winlog.event_data.NewProcessName == "python" AND winlog.event_data.CommandLine LIKE "*-c*")
| STATS 
    command_details = MAX(winlog.event_data.CommandLine) 
  BY host.name, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Linux GTFOBins suiiste'moli orqali imtiyozlarni oshirish
INFO:rule_engine:Executing rule: Shubhali Linux Kernel moduli yuklanishi (LKM Rootkit)
INFO:es_client:Executing ES|QL query: FROM auditbeat-*
| WHERE winlog.event_data.NewProcessName IN ("insmod", "modprobe", "rmmod")
  OR (e...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 2:9: Unknown column [winlog.event_data.NewProcessName]\nline 3:38: Unknown column [winlog.event_data.CommandLine]')
ERROR:es_client:Query: FROM auditbeat-*
| WHERE winlog.event_data.NewProcessName IN ("insmod", "modprobe", "rmmod")
  OR (event.action == "executed" AND winlog.event_data.CommandLine LIKE "*modprobe*")
| STATS 
    load_count = COUNT(*) 
  BY host.name, winlog.event_data.TargetUserName, winlog.event_data.CommandLine, @timestamp
| WHERE NOT winlog.event_data.TargetUserName == "root" // Faqat root bo'lmagan foydalanuvchilar shubhali
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Shubhali Linux Kernel moduli yuklanishi (LKM Rootkit)
INFO:rule_engine:Executing rule: SSH kalitlarining ruxsatsiz o'zgarishi (Linux Persistence)
INFO:es_client:Executing ES|QL query: FROM auditbeat-*
| WHERE winlog.event_data.TargetFilename LIKE "*/.ssh/authorized_keys*"
| WHERE eve...
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:09:45] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:09:45] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:09:45] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:09:45] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:09:45] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:09:45] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.203s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 2:9: Unknown column [winlog.event_data.TargetFilename]')
ERROR:es_client:Query: FROM auditbeat-*
| WHERE winlog.event_data.TargetFilename LIKE "*/.ssh/authorized_keys*"
| WHERE event.type IN ("change", "creation", "deletion")
| STATS 
    ssh_mod_count = COUNT(*) 
  BY host.name, winlog.event_data.TargetUserName, winlog.event_data.TargetFilename, winlog.event_data.NewProcessName, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: SSH kalitlarining ruxsatsiz o'zgarishi (Linux Persistence)
INFO:rule_engine:Executing rule: DNS so'rovlari oqimi (DNS Flood / DoS)
INFO:es_client:Executing ES|QL query: FROM packetbeat-*
| WHERE event.dataset == "network_traffic.dns"
| STATS 
    query_count = COUNT(*)...
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.091s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:09:45] "GET /api/stats HTTP/1.1" 200 -
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.043s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 1:1: Unknown index [packetbeat-*]')
ERROR:es_client:Query: FROM packetbeat-*
| WHERE event.dataset == "network_traffic.dns"
| STATS 
    query_count = COUNT(*) 
  BY winlog.event_data.IpAddress, host.name
| WHERE query_count > 1000 // 1 ta tahlil vaqti ichida 1000 tadan ko'p so'rov
| SORT query_count DESC
ERROR:rule_engine:Query execution failed for rule: DNS so'rovlari oqimi (DNS Flood / DoS)
INFO:rule_engine:Executing rule: Ruxsatsiz tarmoq ko'prigi yoki Tunellash (Network Bridge)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE winlog.event_data.DestPort == 443
 ...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.162s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 2:9: Unknown column [winlog.event_data.DestPort], did you mean any of [winlog.event_data.IpAddress, winlog.event_data.IpAddress.keyword]?\nline 3:11: Unknown column [winlog.event_data.Protocol], did you mean any of [winlog.event_data.IpAddress, winlog.event_data.IpAddress.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE winlog.event_data.DestPort == 443
  AND NOT winlog.event_data.Protocol IN ("https", "tls", "ssl")
| STATS 
    traffic_count = COUNT(*) 
  BY host.name, winlog.event_data.IpAddress, @timestamp
| WHERE traffic_count > 10
| SORT traffic_count DESC
ERROR:rule_engine:Query execution failed for rule: Ruxsatsiz tarmoq ko'prigi yoki Tunellash (Network Bridge)
INFO:rule_engine:Executing rule: Cryptomining (Kriptovalyuta qazib olish) tarmog'i aniqlanishi
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*,auditbeat-*
| WHERE winlog.event_data.DestPort IN (3333, 4444, 5555, 6666, 7777, 8...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 2:9: Unknown column [winlog.event_data.DestPort], did you mean any of [winlog.event_data.IpAddress, winlog.event_data.IpAddress.keyword]?\nline 3:6: Unknown column [winlog.event_data.QueryName], did you mean any of [winlog.event_data.IpAddress, winlog.event_data.IpAddress.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*,auditbeat-*
| WHERE winlog.event_data.DestPort IN (3333, 4444, 5555, 6666, 7777, 8888, 9999, 14444)
  OR winlog.event_data.QueryName LIKE "*pool.supportxmr.com*"
  OR winlog.event_data.QueryName LIKE "*nanopool*"
  OR winlog.event_data.QueryName LIKE "*nicehash*"
| STATS 
    traffic_count = COUNT(*) 
  BY host.name, winlog.event_data.IpAddress, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Cryptomining (Kriptovalyuta qazib olish) tarmog'i aniqlanishi
INFO:rule_engine:Executing rule: DMZ zonadan Ichki tarmoqqa ruxsatsiz ulanish (Zone Violation)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE winlog.event_data.IpAddress LIKE "1...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 3:7: Unknown column [winlog.event_data.DestAddress], did you mean any of [winlog.event_data.IpAddress, winlog.event_data.IpAddress.keyword]?\nline 4:11: Unknown column [winlog.event_data.DestPort], did you mean any of [winlog.event_data.IpAddress, winlog.event_data.IpAddress.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE winlog.event_data.IpAddress LIKE "172.16.*.*" // DMZ zonasi
  AND winlog.event_data.DestAddress LIKE "10.*" // Ichki zona
  AND NOT winlog.event_data.DestPort IN (80, 443)
| STATS 
    violation_count = COUNT(*) 
  BY host.name, winlog.event_data.IpAddress, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: DMZ zonadan Ichki tarmoqqa ruxsatsiz ulanish (Zone Violation)
INFO:rule_engine:Executing rule: Ichki portlarni skanerlash (Internal Port Scanning)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE winlog.event_data.DestPort IS NOT N...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.146s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 2:9: Unknown column [winlog.event_data.DestPort], did you mean any of [winlog.event_data.IpAddress, winlog.event_data.IpAddress.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE winlog.event_data.DestPort IS NOT NULL
| STATS 
    unique_ports = COUNT_DISTINCT(winlog.event_data.DestPort),
    total_connections = COUNT(*)
  BY winlog.event_data.IpAddress, host.name
| WHERE total_connections > 50 
| SORT total_connections DESC
ERROR:rule_engine:Query execution failed for rule: Ichki portlarni skanerlash (Internal Port Scanning)
INFO:rule_engine:Executing rule: Katta hajmdagi ma'lumot uzatilishini aniqlash (Exfiltration)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE NOT (winlog.event_data.DestAddress ...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.057s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 2:14: Unknown column [winlog.event_data.DestAddress], did you mean any of [winlog.event_data.IpAddress, winlog.event_data.IpAddress.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE NOT (winlog.event_data.DestAddress LIKE "10.*" OR winlog.event_data.DestAddress LIKE "192.168.*" OR winlog.event_data.DestAddress LIKE "127.0.0.1" OR winlog.event_data.DestAddress == "::1")
  AND winlog.event_data.IpAddress IS NOT NULL
| STATS 
    event_count = COUNT(*)
  BY winlog.event_data.IpAddress, winlog.event_data.DestAddress, host.name
| WHERE event_count > 1000 
| SORT event_count DESC
ERROR:rule_engine:Query execution failed for rule: Katta hajmdagi ma'lumot uzatilishini aniqlash (Exfiltration)
INFO:rule_engine:Executing rule: Nohandart portlarda shubhali protokol ishlatilishi
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE (winlog.event_data.Protocol == "ssh...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.103s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 2:10: Unknown column [winlog.event_data.Protocol], did you mean any of [winlog.event_data.IpAddress, winlog.event_data.IpAddress.keyword]?\nline 2:50: Unknown column [winlog.event_data.DestPort], did you mean any of [winlog.event_data.IpAddress, winlog.event_data.IpAddress.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE (winlog.event_data.Protocol == "ssh" AND winlog.event_data.DestPort != 22)
  OR (winlog.event_data.Protocol == "http" AND NOT winlog.event_data.DestPort IN (80, 8080, 8888))
  OR (winlog.event_data.Protocol == "dns" AND winlog.event_data.DestPort != 53)
| STATS 
    mismatch_count = COUNT(*) 
  BY host.name, winlog.event_data.IpAddress, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Nohandart portlarda shubhali protokol ishlatilishi
INFO:rule_engine:Executing rule: Web skanerlar faolligini aniqlash (Vulnerability Scanning)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE user_agent.original LIKE "*sqlmap*"...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.306s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 2:9: Unknown column [user_agent.original]\nline 7:6: Unknown column [url.path]')
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE user_agent.original LIKE "*sqlmap*" 
  OR user_agent.original LIKE "*nikto*" 
  OR user_agent.original LIKE "*dirbuster*" 
  OR user_agent.original LIKE "*nmap*"
  OR user_agent.original LIKE "*masscan*"
  OR url.path LIKE "*shell*"
  OR message LIKE "*sqlmap*"
| STATS 
    scan_count = COUNT(*) 
  BY host.name, winlog.event_data.IpAddress, @timestamp
| WHERE scan_count > 5
| SORT scan_count DESC
ERROR:rule_engine:Query execution failed for rule: Web skanerlar faolligini aniqlash (Vulnerability Scanning)
INFO:rule_engine:Executing rule: Ehtimoliy DNS Tunneling xavfi
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE winlog.event_data.QueryName IS NOT ...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 2:9: Unknown column [winlog.event_data.QueryName], did you mean any of [winlog.event_data.IpAddress, winlog.event_data.IpAddress.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE winlog.event_data.QueryName IS NOT NULL
| EVAL domain_len = LENGTH(winlog.event_data.QueryName)
| WHERE domain_len > 100
| STATS 
    avg_len = AVG(domain_len), 
    long_query_count = COUNT(*)
  BY host.name, winlog.event_data.IpAddress, @timestamp
| WHERE long_query_count > 10
| SORT long_query_count DESC
ERROR:rule_engine:Query execution failed for rule: Ehtimoliy DNS Tunneling xavfi
INFO:rule_engine:Executing rule: Eskirgan va zaif TLS protokollari ishlatilishi
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE tls.version IN ("1.0", "1.1") OR tl...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.408s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 2:9: Unknown column [tls.version]\nline 2:42: Unknown column [tls.version_protocol]')
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE tls.version IN ("1.0", "1.1") OR tls.version_protocol == "sslv3"
| STATS 
    usage_count = COUNT(*) 
  BY host.name, winlog.event_data.IpAddress, tls.version, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Eskirgan va zaif TLS protokollari ishlatilishi
INFO:rule_engine:Executing rule: Path Traversal va Local File Inclusion (LFI) aniqlash
INFO:es_client:Executing ES|QL query: FROM filebeat-*
| WHERE event.dataset == "nginx.access" OR event.dataset == "iis.access"
| WHERE url...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 2:9: Unknown column [event.dataset]')
ERROR:es_client:Query: FROM filebeat-*
| WHERE event.dataset == "nginx.access" OR event.dataset == "iis.access"
| WHERE url.path LIKE "*../*" 
  OR url.query LIKE "*../*"
  OR url.query LIKE "*/etc/passwd*"
  OR url.query LIKE "*win.ini*"
  OR url.query LIKE "*/proc/self/*"
  OR url.query LIKE "*%2e%2e%2f*" // URL encoded ../
| STATS 
    traversal_count = COUNT(*) 
  BY winlog.event_data.IpAddress, url.path, url.query, host.name, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Path Traversal va Local File Inclusion (LFI) aniqlash
INFO:rule_engine:Executing rule: Remote Code Execution (RCE) va Command Injection aniqlash
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE url.query LIKE "*${jndi:*" 
  OR ur...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.208s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 2:9: Unknown column [url.query]\nline 7:6: Unknown column [http.request.body.content]')
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE url.query LIKE "*${jndi:*" 
  OR url.query LIKE "*$({*" 
  OR url.query LIKE "*curl *"
  OR url.query LIKE "*bash *"
  OR url.query LIKE "*powershell *"
  OR http.request.body.content LIKE "*${jndi:*"
  OR message LIKE "*${jndi:*"
| STATS 
    rce_attempt_count = COUNT(*) 
  BY host.name, winlog.event_data.IpAddress, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Remote Code Execution (RCE) va Command Injection aniqlash
INFO:rule_engine:Executing rule: Mukammallashgan SQL Injection urinishlari (SQLi)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE url.query LIKE "*SELECT*" 
  OR url...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.044s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 2:9: Unknown column [url.query]')
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE url.query LIKE "*SELECT*" 
  OR url.query LIKE "*UNION*" 
  OR url.query LIKE "*DROP*"
  OR url.query LIKE "*' OR '1'='1*"
  OR url.query LIKE "*information_schema*"
  OR url.query LIKE "*pg_sleep*"
  OR message LIKE "*SELECT*FROM*"
| STATS 
    attack_count = COUNT(*) 
  BY host.name, winlog.event_data.IpAddress, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Mukammallashgan SQL Injection urinishlari (SQLi)
INFO:rule_engine:Executing rule: Cross-Site Scripting (XSS) urinishlarini aniqlash
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE url.query LIKE "*<script>*" 
  OR u...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.158s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 2:9: Unknown column [url.query]')
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*, filebeat-*, packetbeat-*
| WHERE url.query LIKE "*<script>*" 
  OR url.query LIKE "*javascript:*" 
  OR url.query LIKE "*alert(*" 
  OR url.query LIKE "*onerror=*"
  OR url.query LIKE "*%3Cscript%3E*"
  OR message LIKE "*<script>*"
| STATS 
    attack_count = COUNT(*) 
  BY host.name, winlog.event_data.IpAddress, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Cross-Site Scripting (XSS) urinishlarini aniqlash
INFO:rule_engine:Executing rule: Windows Defender yoki xavfsizlik xizmatlarining o'chirilishi
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code == "7040" 
  AND winlog.event_data.Param1 IN ("WinDefend", "Ela...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:7: Unknown column [winlog.event_data.Param1], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*
| WHERE event.code == "7040" 
  AND winlog.event_data.Param1 IN ("WinDefend", "Elastic Agent", "Sysmon", "MpsSvc")
| EVAL service_name = winlog.event_data.Param1 
| STATS 
    event_count = COUNT(*)
  BY host.name, winlog.event_data.TargetUserName, service_name, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Windows Defender yoki xavfsizlik xizmatlarining o'chirilishi
INFO:rule_engine:Executing rule: Shubhali PowerShell Reflection harakatlari
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code == "4104"
  AND (
    powershell.file.script_block_text LIKE "*...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.082s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:5: Unknown column [powershell.file.script_block_text]')
ERROR:es_client:Query: FROM winlogbeat-*
| WHERE event.code == "4104"
  AND (
    powershell.file.script_block_text LIKE "*System.Reflection.Assembly*"
    OR powershell.file.script_block_text LIKE "*System.Reflection.BindingFlags*"
    OR powershell.file.script_block_text LIKE "*Reflect.Module*"
  )
| STATS 
    event_count = COUNT(*) 
  BY winlog.event_data.TargetUserName, host.name, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Shubhali PowerShell Reflection harakatlari
INFO:rule_engine:Executing rule: AMSI Bypass (Anti-Malware Scan Interface) urinishi
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code == "4104"
  AND (
    powershell.file.script_block_text LIKE "*...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.121s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:5: Unknown column [powershell.file.script_block_text]')
ERROR:es_client:Query: FROM winlogbeat-*
| WHERE event.code == "4104"
  AND (
    powershell.file.script_block_text LIKE "*amsiInitFailed*"
    OR powershell.file.script_block_text LIKE "*amsiContext*"
    OR powershell.file.script_block_text LIKE "*[Ref].Assembly.GetType*AmsiUtils*"
    OR powershell.file.script_block_text LIKE "*NonPublic,Static*"
  )
| STATS 
    attempt_count = COUNT(*) 
  BY host.name, winlog.event_data.TargetUserName, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: AMSI Bypass (Anti-Malware Scan Interface) urinishi
INFO:rule_engine:Executing rule: Linux Sudoers fayli manipulyatsiyasi
INFO:es_client:Executing ES|QL query: FROM auditbeat-*
| WHERE winlog.event_data.TargetFilename == "/etc/sudoers" 
  OR winlog.event_data....
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 2:9: Unknown column [winlog.event_data.TargetFilename]')
ERROR:es_client:Query: FROM auditbeat-*
| WHERE winlog.event_data.TargetFilename == "/etc/sudoers" 
  OR winlog.event_data.TargetFilename LIKE "/etc/sudoers.d/*"
| WHERE event.type IN ("change", "deletion", "creation")
  AND NOT winlog.event_data.TargetUserName == "root"
| STATS 
    count() 
  BY host.name, winlog.event_data.TargetUserName, winlog.event_data.TargetFilename, winlog.event_data.NewProcessName, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Linux Sudoers fayli manipulyatsiyasi
INFO:rule_engine:Executing rule: MS Office dasturlari orqali shubhali buyruqlar (Malware)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE winlog.event_data.ParentProcessName IN ("winword.exe", "excel.exe", "power...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.203s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 6:122: Unknown column [winlog.event_data.CommandLine], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, winlog.event_data.ParentProcessName, winlog.event_data.NewProcessName.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*
| WHERE winlog.event_data.ParentProcessName IN ("winword.exe", "excel.exe", "powerspnt.exe", "outlook.exe")
  AND winlog.event_data.NewProcessName IN ("cmd.exe", "powershell.exe", "wscript.exe", "cscript.exe", "mshta.exe")
| STATS 
    office_attack_count = COUNT(*) 
  BY host.name, winlog.event_data.TargetUserName, winlog.event_data.ParentProcessName, winlog.event_data.NewProcessName, winlog.event_data.CommandLine, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: MS Office dasturlari orqali shubhali buyruqlar (Malware)
INFO:rule_engine:Executing rule: Shubhali Scheduled Task yaratilishi (Persistence)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*
| WHERE (winlog.event_data.NewProcessName == "schtasks.exe" AND winlo...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.206s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 2:65: Unknown column [winlog.event_data.CommandLine], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, winlog.event_data.NewProcessName.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*
| WHERE (winlog.event_data.NewProcessName == "schtasks.exe" AND winlog.event_data.CommandLine LIKE "*/create*")
  OR (winlog.event_data.NewProcessName == "powershell.exe" AND winlog.event_data.CommandLine LIKE "*New-ScheduledTask*")
| STATS 
    task_details = MAX(winlog.event_data.CommandLine) 
  BY host.name, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Shubhali Scheduled Task yaratilishi (Persistence)
INFO:rule_engine:Executing rule: Process Hollowing (Xotira manipulyatsiyasi) aniqlanishi
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code == "1" // Process Creation
  AND winlog.event_data.NewProcessNa...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.203s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 7:122: Unknown column [winlog.event_data.CommandLine], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, winlog.event_data.ParentProcessName, winlog.event_data.NewProcessName.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*
| WHERE event.code == "1" // Process Creation
  AND winlog.event_data.NewProcessName LIKE "*Windows*System32*"
  AND NOT (winlog.event_data.ParentProcessName LIKE "*explorer*" OR winlog.event_data.ParentProcessName LIKE "*services*" OR winlog.event_data.ParentProcessName LIKE "*svchost*")
| STATS 
    event_count = COUNT(*) 
  BY host.name, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, winlog.event_data.ParentProcessName, winlog.event_data.CommandLine, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Process Hollowing (Xotira manipulyatsiyasi) aniqlanishi
INFO:rule_engine:Executing rule: Ransomware harakati - ommaviy fayl nomini o'zgartirish
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, winlogbeat-*
| WHERE event.type == "change" OR event.action == "renamed"
| STATS 
...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:4.607s]
/home/mikro/All-ESQL-standart-rules/es_client.py:52: ElasticsearchWarning: Line 2:35: evaluation of [event.action == \
  response = self.client.esql.query(
/home/mikro/All-ESQL-standart-rules/es_client.py:52: ElasticsearchWarning: ] failed, treating result as null. Only first 20 failures recorded.
  response = self.client.esql.query(
/home/mikro/All-ESQL-standart-rules/es_client.py:52: ElasticsearchWarning: Line 2:35: java.lang.IllegalArgumentException: single-value function encountered multi-value
  response = self.client.esql.query(
INFO:rule_engine:Executing rule: Shubhali DLL Sideloading harakatlari
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code == "7" // Sysmon: Image loaded
  AND (
    winlog.event_data.Ta...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.101s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:5: Unknown column [winlog.event_data.TargetFilename], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword, winlog.event_data.NewProcessName, winlog.event_data.NewProcessName.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*
| WHERE event.code == "7" // Sysmon: Image loaded
  AND (
    winlog.event_data.TargetFilename LIKE "*Users*" 
    OR winlog.event_data.TargetFilename LIKE "*ProgramData*" 
    OR winlog.event_data.TargetFilename LIKE "*Temp*"
  )
  AND winlog.event_data.NewProcessName LIKE "*Windows*"
| EVAL dll_path = winlog.event_data.TargetFilename 
| STATS 
    load_count = COUNT(*) 
  BY host.name, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, dll_path, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Shubhali DLL Sideloading harakatlari
INFO:rule_engine:Executing rule: LOLBins (Living off the Land) orqali shubhali fayl yuklab olish
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*
| WHERE (winlog.event_data.NewProcessName == "certutil.exe" AND winlo...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 2:65: Unknown column [winlog.event_data.CommandLine], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, winlog.event_data.NewProcessName.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*
| WHERE (winlog.event_data.NewProcessName == "certutil.exe" AND winlog.event_data.CommandLine LIKE "*-urlcache*")
  OR (winlog.event_data.NewProcessName == "bitsadmin.exe" AND winlog.event_data.CommandLine LIKE "*/transfer*")
  OR (winlog.event_data.NewProcessName == "curl.exe" OR winlog.event_data.NewProcessName == "wget.exe")
| STATS 
    download_command = MAX(winlog.event_data.CommandLine) 
  BY host.name, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: LOLBins (Living off the Land) orqali shubhali fayl yuklab olish
INFO:rule_engine:Executing rule: WMI orqali barqarorlik (Persistence) yaratish
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code IN ("19", "20", "21") // Sysmon WMI events
| EVAL wmi_operation...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:64: Unknown column [winlog.event_data.EventNamespace], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.Operation, winlog.event_data.Operation.keyword, winlog.event_data.TargetUserName.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*
| WHERE event.code IN ("19", "20", "21") // Sysmon WMI events
| EVAL wmi_operation = winlog.event_data.Operation, wmi_name = winlog.event_data.EventNamespace
| STATS 
    wmi_event_count = COUNT(*) 
  BY host.name, winlog.event_data.TargetUserName, wmi_operation, wmi_name, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: WMI orqali barqarorlik (Persistence) yaratish
INFO:rule_engine:Executing rule: Web-serverdan shubhali buyruqlar bajarilishi (Web Shell)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*
| WHERE winlog.event_data.ParentProcessName IN ("w3wp.exe", "httpd.ex...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 6:122: Unknown column [winlog.event_data.CommandLine], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, winlog.event_data.ParentProcessName, winlog.event_data.NewProcessName.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*
| WHERE winlog.event_data.ParentProcessName IN ("w3wp.exe", "httpd.exe", "nginx.exe", "php-cgi.exe")
  AND winlog.event_data.NewProcessName IN ("cmd.exe", "powershell.exe", "sh", "bash", "whoami")
| STATS 
    count() 
  BY host.name, winlog.event_data.TargetUserName, winlog.event_data.ParentProcessName, winlog.event_data.NewProcessName, winlog.event_data.CommandLine, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Web-serverdan shubhali buyruqlar bajarilishi (Web Shell)
INFO:rule_engine:Executing rule: Tizim binar fayllarining ruxsatsiz o'zgarishi (FIM)
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, winlogbeat-*
| WHERE winlog.event_data.TargetFilename LIKE "C:\\\\Windows\\\\Syste...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 2:9: Unknown column [winlog.event_data.TargetFilename], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword, winlog.event_data.NewProcessName, winlog.event_data.NewProcessName.keyword]?')
ERROR:es_client:Query: FROM auditbeat-*, winlogbeat-*
| WHERE winlog.event_data.TargetFilename LIKE "C:\\\\Windows\\\\System32\\\\*.exe" 
  OR winlog.event_data.TargetFilename LIKE "C:\\\\Windows\\\\System32\\\\*.dll"
| WHERE event.type IN ("change", "deletion", "creation")
  AND NOT winlog.event_data.NewProcessName IN ("trustedinstaller.exe", "msiexec.exe", "TiWorker.exe")
| STATS 
    action_count = COUNT(*) 
  BY host.name, winlog.event_data.TargetUserName, winlog.event_data.TargetFilename, event.type, winlog.event_data.NewProcessName, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Tizim binar fayllarining ruxsatsiz o'zgarishi (FIM)
INFO:rule_engine:Executing rule: Windows Process Injection (Sysmon orqali)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code == "8" // Sysmon Event ID 8: CreateRemoteThread
  AND NOT winlo...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.035s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:11: Unknown column [process.target.executable]')
ERROR:es_client:Query: FROM winlogbeat-*
| WHERE event.code == "8" // Sysmon Event ID 8: CreateRemoteThread
  AND NOT winlog.event_data.NewProcessName LIKE "*Windows*System32*"
  AND NOT process.target.executable LIKE "*Windows*System32*"
| STATS 
    injection_count = COUNT(*) 
  BY host.name, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Windows Process Injection (Sysmon orqali)
INFO:rule_engine:Executing rule: Shubhali Registry o'zgarishi (Persistence)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE event.code == "13" // Sysmon Event ID 13: RegistryValueSet
  AND (
    win...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.168s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:5: Unknown column [winlog.event_data.TargetObject], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*
| WHERE event.code == "13" // Sysmon Event ID 13: RegistryValueSet
  AND (
    winlog.event_data.TargetObject LIKE "*CurrentVersion*Run*" 
    OR winlog.event_data.TargetObject LIKE "*CurrentVersion*RunOnce*"
    OR winlog.event_data.TargetObject LIKE "*Winlogon*Shell*"
  )
| EVAL reg_path = winlog.event_data.TargetObject 
| STATS 
    mod_count = COUNT(*) 
  BY host.name, winlog.event_data.TargetUserName, reg_path, @timestamp
| SORT @timestamp DESC
ERROR:rule_engine:Query execution failed for rule: Shubhali Registry o'zgarishi (Persistence)
INFO:rule_engine:Executing rule: Unexpected Port Open on CDE System
INFO:es_client:Executing ES|QL query: FROM metricbeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE winlog.event_data.De...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.102s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 3:9: Unknown column [winlog.event_data.DestPort]\nline 4:7: Unknown column [network.direction]')
ERROR:es_client:Query: FROM metricbeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE winlog.event_data.DestPort IS NOT NULL 
  AND network.direction == "inbound"
  AND host.name RLIKE ".*(cde|payment|pos|gateway).*"
| WHERE winlog.event_data.DestPort NOT IN (22, 443, 3306, 5432, 8443)
| STATS 
    connection_count = COUNT(*),
    unique_sources = COUNT_DISTINCT(winlog.event_data.IpAddress)
  BY winlog.event_data.DestPort, host.name, winlog.event_data.Protocol
| WHERE connection_count >= 3
| EVAL severity = "high"
| KEEP @timestamp, host.name, winlog.event_data.DestPort, winlog.event_data.Protocol, connection_count, unique_sources, severity
ERROR:rule_engine:Query execution failed for rule: Unexpected Port Open on CDE System
INFO:rule_engine:Executing rule: Inbound Connection from Untrusted Network to CDE
INFO:es_client:Executing ES|QL query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE network.direction == "inbound"
  ...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.510s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 3:9: Unknown column [network.direction]\nline 5:7: Unknown column [winlog.event_data.IpAddress]')
ERROR:es_client:Query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE network.direction == "inbound"
  AND host.name RLIKE ".*(cde|payment|cardholder).*"
  AND winlog.event_data.IpAddress NOT RLIKE "^10\\.|^172\\.(1[6-9]|2[0-9]|3[0-1])\\.|^192\\.168\\."
| WHERE winlog.event_data.IpAddress NOT IN ("203.0.113.10", "198.51.100.50")
| STATS 
    connection_count = COUNT(*),
    ports_accessed = VALUES(winlog.event_data.DestPort)
  BY winlog.event_data.IpAddress, source.geo.country_name, host.name
| WHERE connection_count >= 1
| EVAL severity = "critical"
| KEEP @timestamp, winlog.event_data.IpAddress, source.geo.country_name, host.name, winlog.event_data.DestPort, ports_accessed, connection_count, severity
ERROR:rule_engine:Query execution failed for rule: Inbound Connection from Untrusted Network to CDE
INFO:rule_engine:Executing rule: Audit Log Deletion or Tampering
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE (event.co...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.050s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:12: Unknown column [winlog.event_data.TargetFilename], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword]?')
ERROR:es_client:Query: FROM auditbeat-*, winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE (event.code IN ("1102", "1104", "4719")
        OR winlog.event_data.TargetFilename RLIKE ".*/var/log/(audit|secure|auth\\.log).*" AND event.action IN ("deleted", "modified")
        OR message RLIKE ".*(audit.*cleared|log.*deleted|auditd.*stopped).*")
  AND host.name RLIKE ".*(cde|payment|prod).*"
| EVAL severity = "critical"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, winlog.event_data.TargetFilename, event.code, event.action, message, severity
ERROR:rule_engine:Query execution failed for rule: Audit Log Deletion or Tampering
INFO:rule_engine:Executing rule: Log Collection Failure for CDE System
INFO:es_client:Executing ES|QL query: FROM metricbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE (monitor.status == "d...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.161s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 3:10: Unknown column [monitor.status]\nline 4:13: Unknown column [monitor.name], did you mean [host.name]?')
ERROR:es_client:Query: FROM metricbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE (monitor.status == "down" 
        AND monitor.name RLIKE ".*(filebeat|winlogbeat|rsyslog).*")
    OR message RLIKE ".*(log forwarding|syslog.*failed|beat.*stopped).*"
| WHERE host.name RLIKE ".*(cde|payment|cardholder).*"
| STATS down_duration = MAX(@timestamp) - MIN(@timestamp) BY host.name, monitor.name
| WHERE down_duration >= 600000
| EVAL severity = "high"
| KEEP @timestamp, host.name, monitor.name, monitor.status, down_duration, severity
ERROR:rule_engine:Query execution failed for rule: Log Collection Failure for CDE System
INFO:rule_engine:Executing rule: Log Review Activity Not Detected
INFO:es_client:Executing ES|QL query: FROM filebeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 24 hours
| WHERE (message RLIKE ".*(kiban...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.406s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 3 problems\nline 4:13: Unknown column [winlog.event_data.TargetUserName]\nline 5:9: Unknown column [url.path]\nline 6:13: Unknown column [http.request.method]')
ERROR:es_client:Query: FROM filebeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 24 hours
| WHERE (message RLIKE ".*(kibana|elasticsearch|siem).*"
        AND winlog.event_data.TargetUserName IN ("security-analyst", "log-reviewer", "soc-team"))
    OR (url.path RLIKE ".*/app/kibana.*" 
        AND http.request.method IN ("GET", "POST"))
| STATS review_sessions = COUNT(*) BY winlog.event_data.TargetUserName
| WHERE review_sessions >= 1
| EVAL severity = "low"
| KEEP @timestamp, winlog.event_data.TargetUserName, review_sessions, severity
ERROR:rule_engine:Query execution failed for rule: Log Review Activity Not Detected
INFO:rule_engine:Executing rule: Time Synchronization Failure
INFO:es_client:Executing ES|QL query: FROM filebeat-*, metricbeat-*
| WHERE @timestamp >= NOW() - 30 minutes
| WHERE (message RLIKE ".*(nt...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.092s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 9:8: Unknown column [@timestamp]\nline 9:46: Unknown column [message]')
ERROR:es_client:Query: FROM filebeat-*, metricbeat-*
| WHERE @timestamp >= NOW() - 30 minutes
| WHERE (message RLIKE ".*(ntp.*fail|time sync.*error|chronyd.*unreachable).*"
        OR message RLIKE ".*(clock.*skew|time.*offset).*")
  AND host.name RLIKE ".*(cde|payment).*"
| STATS sync_failures = COUNT(*) BY host.name
| WHERE sync_failures >= 3
| EVAL severity = "medium"
| KEEP @timestamp, host.name, sync_failures, message, severity
ERROR:rule_engine:Query execution failed for rule: Time Synchronization Failure
INFO:rule_engine:Executing rule: Wireless Access Point Detected in CDE
INFO:es_client:Executing ES|QL query: FROM metricbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 30 minutes
| WHERE (message RLIKE ".*(SS...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.211s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:12: Unknown column [winlog.event_data.Protocol]')
ERROR:es_client:Query: FROM metricbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 30 minutes
| WHERE (message RLIKE ".*(SSID|wireless|802\\.11|access point).*"
        OR winlog.event_data.Protocol == "ieee80211")
  AND (host.name RLIKE ".*(cde|payment|datacenter).*"
       OR message RLIKE ".*unauthorized.*wireless.*")
| WHERE message NOT RLIKE ".*(approved-wifi|guest-network|corp-ssid).*"
| STATS ap_detections = COUNT(*) BY host.name, message
| WHERE ap_detections >= 1
| EVAL severity = "critical"
| KEEP @timestamp, host.name, message, ap_detections, severity
ERROR:rule_engine:Query execution failed for rule: Wireless Access Point Detected in CDE
INFO:rule_engine:Executing rule: Vulnerability Scanner Detection Evasion
INFO:es_client:Executing ES|QL query: FROM metricbeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE (winlog.event_data.I...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 3 problems\nline 3:10: Unknown column [winlog.event_data.IpAddress]\nline 4:13: Unknown column [winlog.event_data.DestPort]\nline 5:9: Unknown column [winlog.event_data.NewProcessName]')
ERROR:es_client:Query: FROM metricbeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE (winlog.event_data.IpAddress IN ("10.50.100.10", "10.50.100.11")
        AND winlog.event_data.DestPort IN (0, 9999, 31337))
    OR (winlog.event_data.NewProcessName IN ("iptables", "firewall-cmd") 
        AND process.args RLIKE ".*(DROP|REJECT).*(10\\.50\\.100).*")
| WHERE host.name RLIKE ".*(cde|payment).*"
| STATS evasion_count = COUNT(*) BY host.name, winlog.event_data.TargetUserName
| WHERE evasion_count >= 1
| EVAL severity = "high"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, winlog.event_data.IpAddress, process.args, evasion_count, severity
ERROR:rule_engine:Query execution failed for rule: Vulnerability Scanner Detection Evasion
INFO:rule_engine:Executing rule: Network Scan from Unauthorized Source
INFO:es_client:Executing ES|QL query: FROM metricbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE (winlog.event_data.De...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.203s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 3:10: Unknown column [winlog.event_data.DestPort]\nline 5:7: Unknown column [winlog.event_data.IpAddress]')
ERROR:es_client:Query: FROM metricbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE (winlog.event_data.DestPort IN (0, 21, 22, 23, 25, 80, 110, 443, 445, 3306, 3389, 8080)
        OR message RLIKE ".*(port scan|nmap|masscan).*")
  AND winlog.event_data.IpAddress NOT IN ("10.50.100.10", "10.50.100.11", "203.0.113.100")
| STATS 
    unique_ports = COUNT_DISTINCT(winlog.event_data.DestPort),
    port_list = VALUES(winlog.event_data.DestPort)
  BY winlog.event_data.IpAddress, winlog.event_data.DestAddress, host.name
| WHERE unique_ports >= 10
| EVAL severity = "medium"
| KEEP @timestamp, winlog.event_data.IpAddress, winlog.event_data.DestAddress, host.name, unique_ports, port_list, severity
ERROR:rule_engine:Query execution failed for rule: Network Scan from Unauthorized Source
INFO:rule_engine:Executing rule: Penetration Test Activity Outside Window
INFO:es_client:Executing ES|QL query: FROM metricbeat-*, auditbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE (winlog....
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'parsing_exception', "line 11:119: token recognition error at: '-'")
ERROR:es_client:Query: FROM metricbeat-*, auditbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE (winlog.event_data.NewProcessName IN ("metasploit", "burpsuite", "sqlmap", "nikto", "dirb")
        OR http.request.headers.user-agent RLIKE ".*(sqlmap|nikto|burp|metasploit|acunetix).*"
        OR url.path RLIKE ".*(\\.\\./|union select|<script>).*")
  AND host.name RLIKE ".*(cde|payment).*"
| WHERE labels.pentest_window != true OR labels.pentest_window IS NULL
| STATS attack_count = COUNT(*) BY winlog.event_data.IpAddress, host.name, winlog.event_data.NewProcessName
| WHERE attack_count >= 5
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.IpAddress, host.name, winlog.event_data.NewProcessName, http.request.headers.user-agent, attack_count, severity
ERROR:rule_engine:Query execution failed for rule: Penetration Test Activity Outside Window
INFO:rule_engine:Executing rule: File Integrity Monitoring Alert
INFO:es_client:Executing ES|QL query: FROM auditbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.module == "file_integrity"
 ...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.220s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 5:8: Unknown column [winlog.event_data.TargetFilename]')
ERROR:es_client:Query: FROM auditbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.module == "file_integrity"
  AND event.action IN ("updated", "deleted", "attributes_modified")
  AND (winlog.event_data.TargetFilename RLIKE ".*/opt/payment-app/.*"
       OR winlog.event_data.TargetFilename RLIKE ".*\\\\PaymentGateway\\\\.*")
| WHERE winlog.event_data.TargetFilename NOT RLIKE ".*(log|tmp|cache).*"
| EVAL severity = "high"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, winlog.event_data.TargetFilename, file.hash.sha256, event.action, severity
ERROR:rule_engine:Query execution failed for rule: File Integrity Monitoring Alert
INFO:rule_engine:Executing rule: Emergency Incident Response Trigger
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, metricbeat-*, filebeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| ...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.190s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 4 problems\nline 5:12: Unknown column [winlog.event_data.TargetFilename], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword, winlog.event_data.NewProcessName, winlog.event_data.NewProcessName.keyword]?\nline 6:67: Unknown column [network.bytes]\nline 7:12: Unknown column [winlog.event_data.Protocol], did you mean any of [winlog.event_data.NewProcessName, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName.keyword, winlog.event_data.TargetUserName.keyword]?\nline 7:52: Unknown column [winlog.event_data.DestPort], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, winlog.event_data.NewProcessName.keyword, winlog.event_data.TargetUserName.keyword]?')
ERROR:es_client:Query: FROM auditbeat-*, metricbeat-*, filebeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE (event.code IN ("1102", "4720", "4732")
        OR message RLIKE ".*[0-9]{4}[- ]?[0-9]{4}[- ]?[0-9]{4}[- ]?[0-9]{4}.*"
        OR winlog.event_data.TargetFilename RLIKE ".*(cardholder|chd).*" AND event.action IN ("accessed", "deleted")
        OR winlog.event_data.NewProcessName IN ("zip", "tar") AND network.bytes > 10485760
        OR winlog.event_data.Protocol != "tls" AND winlog.event_data.DestPort IN (443, 8443))
  AND host.name RLIKE ".*(cde|payment|cardholder).*"
| STATS 
    critical_signals = COUNT_DISTINCT(event.action),
    hosts_affected = COUNT_DISTINCT(host.name),
    users_involved = VALUES(winlog.event_data.TargetUserName),
    event_types = VALUES(event.category)
  BY host.name
| WHERE critical_signals >= 2
| EVAL severity = "critical"
| KEEP @timestamp, host.name, critical_signals, hosts_affected, users_involved, event_types, severity
ERROR:rule_engine:Query execution failed for rule: Emergency Incident Response Trigger
INFO:rule_engine:Executing rule: Correlated Payment Card Compromise Indicators
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, metricbeat-*, filebeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 30 minutes
| ...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:1.768s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 4:12: Unknown column [winlog.event_data.TargetFilename], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword, winlog.event_data.NewProcessName, winlog.event_data.NewProcessName.keyword]?\nline 5:70: Unknown column [network.bytes]')
ERROR:es_client:Query: FROM auditbeat-*, metricbeat-*, filebeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 30 minutes
| WHERE (message RLIKE ".*[0-9]{4}[- ]?[0-9]{4}[- ]?[0-9]{4}[- ]?[0-9]{4}.*"
        OR winlog.event_data.TargetFilename RLIKE ".*(cardholder|chd|pan).*" AND event.action == "accessed")
    OR (winlog.event_data.NewProcessName IN ("zip", "tar", "7z") AND network.bytes > 1048576)
    OR (event.code IN ("1102", "4725") OR message RLIKE ".*audit.*stopped.*")
| STATS 
    pan_exposures = COUNT_IF(message RLIKE ".*[0-9]{16}.*"),
    chd_access = COUNT_IF(winlog.event_data.TargetFilename RLIKE ".*cardholder.*"),
    exfil_attempts = COUNT_IF(winlog.event_data.NewProcessName IN ("zip", "tar")),
    tamper_events = COUNT_IF(event.code == "1102")
  BY winlog.event_data.TargetUserName, host.name
| WHERE (pan_exposures >= 1 AND exfil_attempts >= 1) 
    OR (chd_access >= 10 AND tamper_events >= 1)
| EVAL severity = "critical"
| KEEP @timestamp, winlog.event_data.TargetUserName, host.name, pan_exposures, chd_access, exfil_attempts, tamper_events, severity
ERROR:rule_engine:Query execution failed for rule: Correlated Payment Card Compromise Indicators
INFO:rule_engine:Executing rule: Multiple PCI Violations from Same User
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, metricbeat-*, filebeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 1 hour
| WHER...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:8.780s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 7:7: Unknown column [winlog.event_data.TargetFilename], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword, winlog.event_data.NewProcessName, winlog.event_data.NewProcessName.keyword]?\nline 8:7: Unknown column [winlog.event_data.DestPort], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, winlog.event_data.NewProcessName.keyword, winlog.event_data.TargetUserName.keyword]?')
ERROR:es_client:Query: FROM auditbeat-*, metricbeat-*, filebeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 1 hour
| WHERE (event.category IN ("authentication", "file", "process", "network")
        AND (event.outcome == "failure" 
             OR event.action IN ("accessed", "deleted", "modified")
             OR winlog.event_data.NewProcessName IN ("sudo", "runas", "net", "chmod")))
  OR (winlog.event_data.TargetFilename RLIKE ".*(cardholder|chd|payment|audit).*")
  OR (winlog.event_data.DestPort NOT IN (22, 80, 443, 3306))
| WHERE host.name RLIKE ".*(cde|payment).*"
| STATS 
    violation_types = COUNT_DISTINCT(event.category),
    total_violations = COUNT(*)
  BY winlog.event_data.TargetUserName, host.name
| WHERE violation_types >= 3 OR total_violations >= 10
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.TargetUserName, host.name, violation_types, total_violations, severity
ERROR:rule_engine:Query execution failed for rule: Multiple PCI Violations from Same User
INFO:rule_engine:Executing rule: Data Exfiltration from CDE System
INFO:es_client:Executing ES|QL query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE network.direction == "outbound"
 ...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.064s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 3:9: Unknown column [network.direction]\nline 5:7: Unknown column [winlog.event_data.DestAddress]')
ERROR:es_client:Query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE network.direction == "outbound"
  AND host.name RLIKE ".*(cde|payment|cardholder).*"
  AND winlog.event_data.DestAddress NOT RLIKE "^10\\.|^172\\.(1[6-9]|2[0-9]|3[0-1])\\.|^192\\.168\\."
| WHERE winlog.event_data.DestAddress NOT IN ("203.0.113.10", "198.51.100.50")
| STATS total_bytes = SUM(network.bytes) BY winlog.event_data.IpAddress, winlog.event_data.DestAddress, host.name, destination.geo.country_name
| WHERE total_bytes >= 104857600
| EVAL severity = "critical"
| KEEP @timestamp, winlog.event_data.IpAddress, winlog.event_data.DestAddress, destination.geo.country_name, host.name, total_bytes, severity
ERROR:rule_engine:Query execution failed for rule: Data Exfiltration from CDE System
INFO:rule_engine:Executing rule: Default Credentials Usage Detected
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.category == "au...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.156s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [event.category], did you mean [event.outcome]?')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.category == "authentication" 
  AND event.outcome == "success"
  AND winlog.event_data.TargetUserName IN ("admin", "administrator", "root", "guest", "test", "default", "sa")
| WHERE host.name RLIKE ".*(cde|payment|prod).*"
| STATS login_count = COUNT(*) BY winlog.event_data.TargetUserName, winlog.event_data.IpAddress, host.name
| WHERE login_count >= 1
| EVAL severity = "critical"
| KEEP @timestamp, winlog.event_data.TargetUserName, winlog.event_data.IpAddress, host.name, login_count, severity
ERROR:rule_engine:Query execution failed for rule: Default Credentials Usage Detected
INFO:rule_engine:Executing rule: Insecure Service Enabled (Telnet, FTP)
INFO:es_client:Executing ES|QL query: FROM metricbeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE (winlog.event_data.D...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.092s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 3:10: Unknown column [winlog.event_data.DestPort]\nline 4:12: Unknown column [winlog.event_data.Protocol]')
ERROR:es_client:Query: FROM metricbeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE (winlog.event_data.DestPort IN (21, 23, 512, 513, 514) 
        OR winlog.event_data.Protocol IN ("telnet", "ftp"))
  AND host.name RLIKE ".*(cde|payment|cardholder).*"
| STATS 
    connection_count = COUNT(*),
    unique_clients = COUNT_DISTINCT(winlog.event_data.IpAddress)
  BY winlog.event_data.DestPort, winlog.event_data.Protocol, host.name
| WHERE connection_count >= 1
| EVAL severity = "high"
| KEEP @timestamp, host.name, winlog.event_data.DestPort, winlog.event_data.Protocol, connection_count, unique_clients, severity
ERROR:rule_engine:Query execution failed for rule: Insecure Service Enabled (Telnet, FTP)
INFO:rule_engine:Executing rule: Unnecessary Service Running on CDE Host
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, metricbeat-*
| WHERE @timestamp >= NOW() - 30 minutes
| WHERE winlog.event_data.Ne...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.610s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [winlog.event_data.NewProcessName]')
ERROR:es_client:Query: FROM auditbeat-*, metricbeat-*
| WHERE @timestamp >= NOW() - 30 minutes
| WHERE winlog.event_data.NewProcessName IS NOT NULL
  AND host.name RLIKE ".*(payment-app|pos-terminal|card-processor).*"
  AND winlog.event_data.NewProcessName IN ("httpd", "nginx", "apache2", "mysql", "postgres", "mongod", "redis", "memcached", "docker", "jenkins", "gitlab")
| STATS 
    process_count = COUNT(*),
    services = VALUES(winlog.event_data.NewProcessName)
  BY host.name
| WHERE process_count >= 3
| EVAL severity = "medium"
| KEEP @timestamp, host.name, services, process_count, severity
ERROR:rule_engine:Query execution failed for rule: Unnecessary Service Running on CDE Host
INFO:rule_engine:Executing rule: Unencrypted Cardholder Data File Access
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.action IN ("ac...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.199s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:8: Unknown column [winlog.event_data.TargetFilename], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword]?')
ERROR:es_client:Query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.action IN ("accessed", "read", "opened")
  AND (winlog.event_data.TargetFilename RLIKE ".*(cardholder|chd|pan|card_data).*"
       OR winlog.event_data.TargetFilename RLIKE ".*/opt/payment/data/.*")
  AND file.extension NOT IN ("enc", "aes", "pgp", "gpg")
| WHERE winlog.event_data.TargetUserName NOT IN ("payment-app-service", "encryption-service")
| STATS file_count = COUNT(*) BY winlog.event_data.TargetUserName, host.name, winlog.event_data.TargetFilename
| WHERE file_count >= 1
| EVAL severity = "critical"
| KEEP @timestamp, winlog.event_data.TargetUserName, host.name, winlog.event_data.TargetFilename, file_count, severity
ERROR:rule_engine:Query execution failed for rule: Unencrypted Cardholder Data File Access
INFO:rule_engine:Executing rule: Database Encryption Key Access
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE (winlog.event_data.Tar...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.059s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:10: Unknown column [winlog.event_data.TargetFilename]')
ERROR:es_client:Query: FROM auditbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE (winlog.event_data.TargetFilename RLIKE ".*(keystore|keys|master\\.key|encryption\\.key).*"
        OR winlog.event_data.TargetFilename RLIKE ".*/etc/ssl/private/.*")
  AND event.action IN ("accessed", "read", "copied", "modified")
| WHERE winlog.event_data.TargetUserName NOT IN ("root", "ssl-cert", "keymanager-service")
| EVAL severity = "critical"
| KEEP @timestamp, winlog.event_data.TargetUserName, host.name, winlog.event_data.TargetFilename, event.action, winlog.event_data.NewProcessName, severity
ERROR:rule_engine:Query execution failed for rule: Database Encryption Key Access
INFO:rule_engine:Executing rule: PAN-Like Pattern Detected in Logs
INFO:es_client:Executing ES|QL query: FROM filebeat-*, metricbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE message RLIKE ".*[0-9...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.147s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:6: Unknown column [http.request.body.content]')
ERROR:es_client:Query: FROM filebeat-*, metricbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE message RLIKE ".*[0-9]{4}[- ]?[0-9]{4}[- ]?[0-9]{4}[- ]?[0-9]{4}.*"
  OR http.request.body.content RLIKE ".*[0-9]{13,19}.*"
| WHERE message NOT RLIKE ".*(XXXX|\\*\\*\\*\\*|masked).*"
| STATS pan_occurrences = COUNT(*) BY host.name, log.winlog.event_data.TargetFilename
| WHERE pan_occurrences >= 1
| EVAL severity = "critical"
| KEEP @timestamp, host.name, log.winlog.event_data.TargetFilename, pan_occurrences, severity
ERROR:rule_engine:Query execution failed for rule: PAN-Like Pattern Detected in Logs
INFO:rule_engine:Executing rule: Mass Query on Payment Database
INFO:es_client:Executing ES|QL query: FROM filebeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE message RLIKE ".*SELEC...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.045s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:6: Unknown column [process.args]')
ERROR:es_client:Query: FROM filebeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE message RLIKE ".*SELECT.*FROM.*(payment|transaction|card|cardholder).*"
  OR process.args RLIKE ".*SELECT \\* FROM.*"
| WHERE message NOT RLIKE ".*(LIMIT [0-9]{1,2}|WHERE id =).*"
| STATS query_count = COUNT(*) BY winlog.event_data.TargetUserName, host.name
| WHERE query_count >= 5
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.TargetUserName, host.name, query_count, message, severity
ERROR:rule_engine:Query execution failed for rule: Mass Query on Payment Database
INFO:rule_engine:Executing rule: Cleartext Transmission on Payment Port
INFO:es_client:Executing ES|QL query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE winlog.event_data.Protocol == "ht...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.048s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 4 problems\nline 3:9: Unknown column [winlog.event_data.Protocol]\nline 4:7: Unknown column [winlog.event_data.DestPort]\nline 5:8: Unknown column [http.request.body.content]\nline 6:11: Unknown column [url.path]')
ERROR:es_client:Query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE winlog.event_data.Protocol == "http" 
  AND winlog.event_data.DestPort IN (80, 8080, 8000, 3000)
  AND (http.request.body.content RLIKE ".*(card|pan|cvv|expiry).*"
       OR url.path RLIKE ".*(payment|checkout|transaction).*")
| STATS 
    request_count = COUNT(*),
    urls = VALUES(url.path)
  BY winlog.event_data.IpAddress, winlog.event_data.DestAddress, host.name
| WHERE request_count >= 1
| EVAL severity = "critical"
| KEEP @timestamp, winlog.event_data.IpAddress, winlog.event_data.DestAddress, url.path, urls, request_count, severity
ERROR:rule_engine:Query execution failed for rule: Cleartext Transmission on Payment Port
INFO:rule_engine:Executing rule: Certificate Validation Failure
INFO:es_client:Executing ES|QL query: FROM metricbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE (tls.server.x509.not_...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.061s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 5 problems\nline 3:10: Unknown column [tls.server.x509.not_after]\nline 4:12: Unknown column [tls.established]\nline 5:12: Unknown column [tls.server.x509.issuer.common_name]\nline 5:50: Unknown column [tls.server.x509.subject.common_name]\nline 6:7: Unknown column [winlog.event_data.DestPort]')
ERROR:es_client:Query: FROM metricbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE (tls.server.x509.not_after < NOW()
        OR tls.established == false
        OR tls.server.x509.issuer.common_name == tls.server.x509.subject.common_name)
  AND winlog.event_data.DestPort IN (443, 8443)
  AND host.name RLIKE ".*(payment|gateway|pos).*"
| STATS 
    failed_count = COUNT(*),
    cert_issues = VALUES(tls.server.x509.subject.common_name)
  BY winlog.event_data.DestAddress, host.name
| WHERE failed_count >= 1
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.DestAddress, host.name, tls.server.x509.subject.common_name, tls.server.x509.not_after, cert_issues, failed_count, severity
ERROR:rule_engine:Query execution failed for rule: Certificate Validation Failure
INFO:rule_engine:Executing rule: Unencrypted Payment Gateway Connection
INFO:es_client:Executing ES|QL query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE (destination.domain RLIKE ".*(pay...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.048s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 4 problems\nline 3:10: Unknown column [destination.domain]\nline 4:12: Unknown column [winlog.event_data.DestAddress]\nline 5:7: Unknown column [winlog.event_data.Protocol]\nline 6:7: Unknown column [winlog.event_data.DestPort]')
ERROR:es_client:Query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE (destination.domain RLIKE ".*(paypal|stripe|authorize\\.net|firstdata).*"
        OR winlog.event_data.DestAddress IN ("64.14.227.5", "64.4.250.37"))
  AND winlog.event_data.Protocol != "tls"
  AND winlog.event_data.DestPort NOT IN (443, 8443)
| STATS 
    connection_count = COUNT(*),
    protocols = VALUES(winlog.event_data.Protocol)
  BY winlog.event_data.IpAddress, destination.domain, host.name
| WHERE connection_count >= 1
| EVAL severity = "critical"
| KEEP @timestamp, winlog.event_data.IpAddress, destination.domain, winlog.event_data.DestAddress, winlog.event_data.Protocol, protocols, connection_count, severity
ERROR:rule_engine:Query execution failed for rule: Unencrypted Payment Gateway Connection
INFO:rule_engine:Executing rule: Antivirus Disabled or Stopped
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE (event.co...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 5:12: Unknown column [process.args]')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE (event.code IN ("5001", "1116", "1117")
        OR message RLIKE ".*(antivirus|malware|defender).*stopped.*"
        OR process.args RLIKE ".*(sc stop|systemctl stop).*(av|clamav|defender).*")
  AND host.name RLIKE ".*(cde|payment|prod).*"
| EVAL severity = "critical"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, event.code, message, process.args, severity
ERROR:rule_engine:Query execution failed for rule: Antivirus Disabled or Stopped
INFO:rule_engine:Executing rule: Malware Signature Update Failed
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 24 hours
| WHERE (event.code IN ("2001",...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.206s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 10:8: Unknown column [@timestamp]\nline 10:46: Unknown column [message]')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 24 hours
| WHERE (event.code IN ("2001", "2003", "2012")
        OR message RLIKE ".*(signature|definition).*update.*fail.*"
        OR message RLIKE ".*virus.*database.*out.*date.*")
  AND host.name RLIKE ".*(cde|payment|prod).*"
| STATS failure_count = COUNT(*) BY host.name
| WHERE failure_count >= 3
| EVAL severity = "high"
| KEEP @timestamp, host.name, failure_count, message, severity
ERROR:rule_engine:Query execution failed for rule: Malware Signature Update Failed
INFO:rule_engine:Executing rule: Suspicious Executable in Payment Directory
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.action IN ("cr...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.052s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 5:11: Unknown column [winlog.event_data.TargetFilename], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword]?')
ERROR:es_client:Query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.action IN ("created", "renamed", "moved")
  AND (file.extension IN ("exe", "dll", "so", "sh", "bat", "ps1", "vbs")
       OR winlog.event_data.TargetFilename RLIKE ".*\\.(exe|dll|so|sh|bat|ps1)$")
  AND winlog.event_data.TargetFilename RLIKE ".*(payment|pos|gateway|cardholder).*"
| WHERE winlog.event_data.TargetFilename NOT RLIKE ".*(Program Files|application|bin).*"
| EVAL severity = "high"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, winlog.event_data.TargetFilename, file.hash.sha256, event.action, severity
ERROR:rule_engine:Query execution failed for rule: Suspicious Executable in Payment Directory
INFO:rule_engine:Executing rule: Known Malicious Process Execution
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE winlog.event_data.New...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.152s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:8: Unknown column [process.args]')
ERROR:es_client:Query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE winlog.event_data.NewProcessName IN ("mimikatz.exe", "psexec.exe", "netcat.exe", "nc.exe", "powershell.exe", "cmd.exe")
  AND (process.args RLIKE ".*(invoke-mimikatz|sekurlsa|dump|lsass).*"
       OR process.args RLIKE ".*(-enc|-e |bypass|hidden).*")
| WHERE host.name RLIKE ".*(cde|payment|prod).*"
| EVAL severity = "critical"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, process.args, winlog.event_data.NewProcessName, severity
ERROR:rule_engine:Query execution failed for rule: Known Malicious Process Execution
INFO:rule_engine:Executing rule: Unpatched Critical System in CDE
INFO:es_client:Executing ES|QL query: FROM metricbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 24 hours
| WHERE (message RLIKE ".*(CVE-...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.079s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 9:8: Unknown column [@timestamp]')
ERROR:es_client:Query: FROM metricbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 24 hours
| WHERE (message RLIKE ".*(CVE-20(2[0-9]|1[8-9])-[0-9]{4,5}).*critical.*"
        OR message RLIKE ".*vulnerable.*version.*(apache|nginx|openssl|openssh|mysql).*")
  AND host.name RLIKE ".*(cde|payment|cardholder).*"
| STATS vuln_count = COUNT(*) BY host.name, message
| WHERE vuln_count >= 1
| EVAL severity = "high"
| KEEP @timestamp, host.name, message, vuln_count, severity
ERROR:rule_engine:Query execution failed for rule: Unpatched Critical System in CDE
INFO:rule_engine:Executing rule: Web Application Vulnerability Exploit Attempt
INFO:es_client:Executing ES|QL query: FROM metricbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE (http.request.body.co...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.125s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 3 problems\nline 3:10: Unknown column [http.request.body.content]\nline 4:12: Unknown column [url.query]\nline 6:8: Unknown column [url.path]')
ERROR:es_client:Query: FROM metricbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE (http.request.body.content RLIKE ".*(UNION SELECT|'; DROP TABLE|<script>|javascript:|../../../etc/passwd).*"
        OR url.query RLIKE ".*(\\' OR 1=1|<script|\\.\\./).*"
        OR message RLIKE ".*(SQL injection|XSS attempt|directory traversal).*")
  AND (url.path RLIKE ".*(payment|checkout|transaction|admin).*"
       OR host.name RLIKE ".*(payment-web|gateway-app).*")
| STATS attack_count = COUNT(*) BY winlog.event_data.IpAddress, url.path, host.name
| WHERE attack_count >= 3
| EVAL severity = "critical"
| KEEP @timestamp, winlog.event_data.IpAddress, host.name, url.path, http.request.body.content, attack_count, severity
ERROR:rule_engine:Query execution failed for rule: Web Application Vulnerability Exploit Attempt
INFO:rule_engine:Executing rule: Access to Cardholder Data Outside Business Need
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.action IN ("ac...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.926s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:7: Unknown column [winlog.event_data.TargetFilename], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword]?')
ERROR:es_client:Query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.action IN ("accessed", "read", "opened")
  AND winlog.event_data.TargetFilename RLIKE ".*(cardholder|chd|pan|payment_data).*"
| WHERE winlog.event_data.TargetUserName NOT IN ("payment-app-service", "finance-admin", "compliance-auditor")
| WHERE winlog.event_data.TargetUserName NOT RLIKE ".*(payment|billing|finance).*"
| STATS access_count = COUNT(*) BY winlog.event_data.TargetUserName, host.name, winlog.event_data.TargetFilename
| WHERE access_count >= 1
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.TargetUserName, host.name, winlog.event_data.TargetFilename, access_count, severity
ERROR:rule_engine:Query execution failed for rule: Access to Cardholder Data Outside Business Need
INFO:rule_engine:Executing rule: Role-Based Access Violation
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE (event.code IN ("472...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.201s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:62: Unknown column [process.args]')
ERROR:es_client:Query: FROM winlogbeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE (event.code IN ("4728", "4732", "4756")
        OR winlog.event_data.NewProcessName == "usermod" AND process.args RLIKE ".*-a -G.*")
  AND (winlog.event_data.TargetUserName RLIKE ".*(Administrators|Domain Admins|Payment_Access).*"
       OR process.args RLIKE ".*(sudo|wheel|payment_admins).*")
| WHERE host.name RLIKE ".*(cde|payment).*"
| EVAL severity = "medium"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, winlog.event_data.MemberName, winlog.event_data.TargetUserName, process.args, event.code, severity
ERROR:rule_engine:Query execution failed for rule: Role-Based Access Violation
INFO:rule_engine:Executing rule: Excessive Permission Grant Detected
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE (winlog.event_data.N...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.200s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 3 problems\nline 4:13: Unknown column [process.args]\nline 6:13: Unknown column [winlog.event_data.ObjectName], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, winlog.event_data.NewProcessName.keyword, winlog.event_data.TargetUserName.keyword]?\nline 7:13: Unknown column [winlog.event_data.AccessMask], did you mean any of [winlog.event_data.NewProcessName, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName.keyword, winlog.event_data.TargetUserName.keyword]?')
ERROR:es_client:Query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE (winlog.event_data.NewProcessName IN ("chmod", "chown", "setfacl", "icacls.exe")
        AND process.args RLIKE ".*(777|666|Everyone|Authenticated Users).*")
    OR (event.code == "4670" 
        AND winlog.event_data.ObjectName RLIKE ".*cardholder.*"
        AND winlog.event_data.AccessMask RLIKE ".*(FULL|0x1f01ff).*")
| WHERE winlog.event_data.TargetFilename RLIKE ".*(cardholder|chd|payment|card_data).*"
    OR host.name RLIKE ".*(cde|payment).*"
| EVAL severity = "high"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, process.args, winlog.event_data.TargetFilename, event.code, severity
ERROR:rule_engine:Query execution failed for rule: Excessive Permission Grant Detected
INFO:rule_engine:Executing rule: Shared Account Usage on CDE System
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 1 hour
| WHERE event.category == "authen...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [event.category], did you mean [event.outcome]?')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 1 hour
| WHERE event.category == "authentication" 
  AND event.outcome == "success"
  AND host.name RLIKE ".*(cde|payment|cardholder).*"
| STATS 
    unique_sources = COUNT_DISTINCT(winlog.event_data.IpAddress),
    unique_hosts = COUNT_DISTINCT(host.name),
    source_ips = VALUES(winlog.event_data.IpAddress)
  BY winlog.event_data.TargetUserName
| WHERE unique_sources >= 3
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.TargetUserName, unique_sources, unique_hosts, source_ips, severity
ERROR:rule_engine:Query execution failed for rule: Shared Account Usage on CDE System
INFO:rule_engine:Executing rule: Password Policy Violation
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE (event.code IN ("4723...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.408s]
INFO:rule_engine:Executing rule: Privileged Account Login Without MFA
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.category == "au...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.100s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [event.category], did you mean any of [event.code, event.outcome, event.code.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.category == "authentication" 
  AND event.outcome == "success"
  AND (winlog.event_data.TargetUserName RLIKE ".*(admin|root|sa|dba).*"
       OR winlog.event_data.TargetUserName IN ("Administrator", "Domain Admin"))
| WHERE (message NOT RLIKE ".*(publickey|duo|mfa|2fa|totp).*"
        AND winlog.event_data.AuthenticationPackageName NOT IN ("Negotiate", "Kerberos"))
    OR event.code == "4624" AND winlog.event_data.LogonType == "2"
| WHERE host.name RLIKE ".*(cde|payment).*"
| EVAL severity = "critical"
| KEEP @timestamp, winlog.event_data.TargetUserName, winlog.event_data.IpAddress, host.name, event.code, winlog.event_data.LogonType, severity
ERROR:rule_engine:Query execution failed for rule: Privileged Account Login Without MFA
INFO:rule_engine:Executing rule: Multi-Factor Authentication Bypass Attempt
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.category == "au...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.316s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [event.category], did you mean any of [event.code, event.outcome, event.code.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.category == "authentication" 
  AND event.outcome == "success"
  AND host.name RLIKE ".*(cde|payment|gateway).*"
| WHERE (event.code == "4624" AND winlog.event_data.LogonType IN ("3", "10")
        AND winlog.event_data.AuthenticationPackageName != "Negotiate")
    OR (message RLIKE ".*Accepted password.*" 
        AND message NOT RLIKE ".*publickey|keyboard-interactive.*")
| WHERE winlog.event_data.IpAddress NOT RLIKE "^10\\.|^172\\.16\\.|^192\\.168\\."
| EVAL severity = "critical"
| KEEP @timestamp, winlog.event_data.TargetUserName, winlog.event_data.IpAddress, host.name, event.code, winlog.event_data.LogonType, severity
ERROR:rule_engine:Query execution failed for rule: Multi-Factor Authentication Bypass Attempt
INFO:rule_engine:Executing rule: Session Timeout Not Enforced
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 30 minutes
| WHERE event.category == "se...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.404s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [event.category]')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 30 minutes
| WHERE event.category == "session"
  AND host.name RLIKE ".*(cde|payment).*"
| STATS 
    session_start = MIN(@timestamp),
    last_activity = MAX(@timestamp),
    activity_count = COUNT(*)
  BY winlog.event_data.TargetUserName, host.name, winlog.event_data.LogonId
| EVAL session_duration = (last_activity - session_start) / 60000
| WHERE session_duration >= 15 AND activity_count <= 3
| EVAL severity = "medium"
| KEEP session_start, last_activity, winlog.event_data.TargetUserName, host.name, session_duration, activity_count, severity
ERROR:rule_engine:Query execution failed for rule: Session Timeout Not Enforced
INFO:rule_engine:Executing rule: After-Hours Data Center Access
INFO:es_client:Executing ES|QL query: FROM filebeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE message RLIKE ".*(badg...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.205s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 6:40: Cannot convert string [hour] to [DATETIME], error [failed to parse date field [hour] with format [strict_date_optional_time]]')
ERROR:es_client:Query: FROM filebeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE message RLIKE ".*(badge|card|access control|door|entry).*"
  AND (message RLIKE ".*(datacenter|server room|cage|rack).*"
       OR host.name RLIKE ".*(badge-reader|access-control).*")
| EVAL hour = DATE_EXTRACT(@timestamp, "hour")
| EVAL day_of_week = DATE_EXTRACT(@timestamp, "day_of_week")
| WHERE (hour < 7 OR hour >= 19) OR (day_of_week IN (6, 7))
| EVAL severity = "medium"
| KEEP @timestamp, winlog.event_data.TargetUserName, host.name, message, hour, day_of_week, severity
ERROR:rule_engine:Query execution failed for rule: After-Hours Data Center Access
INFO:rule_engine:Executing rule: Unauthorized Console Access Detected
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.category == "au...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.100s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [event.category], did you mean any of [event.code, event.outcome, event.code.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.category == "authentication" 
  AND event.outcome == "success"
  AND (winlog.event_data.LogonType == "2"
       OR message RLIKE ".*(login.*tty|console login).*")
| WHERE host.name RLIKE ".*(cde|payment|cardholder).*"
  AND winlog.event_data.TargetUserName NOT IN ("root", "administrator", "console-admin")
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.TargetUserName, host.name, event.code, winlog.event_data.LogonType, message, severity
ERROR:rule_engine:Query execution failed for rule: Unauthorized Console Access Detected
INFO:rule_engine:Executing rule: Media Destruction Logging Failure
INFO:es_client:Executing ES|QL query: FROM filebeat-*
| WHERE @timestamp >= NOW() - 7 days
| WHERE message RLIKE ".*(media destruction|har...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.203s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 9:27: Unknown column [@timestamp]')
ERROR:es_client:Query: FROM filebeat-*
| WHERE @timestamp >= NOW() - 7 days
| WHERE message RLIKE ".*(media destruction|hard drive|disk shred|degauss).*"
| STATS 
    destruction_events = COUNT(*),
    last_log = MAX(@timestamp)
  BY host.name
| WHERE destruction_events < 1
| EVAL days_since_last = (@timestamp - last_log) / 86400000
| WHERE days_since_last > 7
| EVAL severity = "medium"
| KEEP @timestamp, host.name, destruction_events, last_log, days_since_last, severity
ERROR:rule_engine:Query execution failed for rule: Media Destruction Logging Failure
INFO:rule_engine:Executing rule: Badge Reader Malfunction or Tamper
INFO:es_client:Executing ES|QL query: FROM filebeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE message RLIKE ".*(badge reader|acce...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 10:8: Unknown column [@timestamp]')
ERROR:es_client:Query: FROM filebeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE message RLIKE ".*(badge reader|access control|door alarm).*"
  AND (message RLIKE ".*(tamper|malfunction|forced|alarm|error|offline).*"
       OR message RLIKE ".*(door.*forced|reader.*offline).*")
| WHERE message RLIKE ".*(datacenter|server room|CDE|payment processing).*"
| STATS alert_count = COUNT(*) BY host.name, message
| WHERE alert_count >= 1
| EVAL severity = "high"
| KEEP @timestamp, host.name, message, alert_count, severity
ERROR:rule_engine:Query execution failed for rule: Badge Reader Malfunction or Tamper
INFO:rule_engine:Executing rule: Firewall Rule Change Detected
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, filebeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE (winlog....
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 4:13: Unknown column [process.args]\nline 5:9: Unknown column [winlog.event_data.TargetFilename], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword, winlog.event_data.NewProcessName, winlog.event_data.NewProcessName.keyword]?')
ERROR:es_client:Query: FROM auditbeat-*, filebeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE (winlog.event_data.NewProcessName IN ("iptables", "firewall-cmd", "ufw", "netsh") 
        AND process.args RLIKE ".*(add|delete|modify|allow|deny).*")
    OR (winlog.event_data.TargetFilename RLIKE ".*/etc/sysconfig/iptables.*" AND event.action == "modified")
    OR (event.code == "4946" OR event.code == "4947")
| WHERE host.name RLIKE ".*(cde|payment|firewall).*"
| EVAL severity = "high"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, process.args, winlog.event_data.TargetFilename, event.code, severity
ERROR:rule_engine:Query execution failed for rule: Firewall Rule Change Detected
INFO:rule_engine:Executing rule: System Configuration Change Without Approval
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.module == "file_...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.203s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 5:8: Unknown column [winlog.event_data.TargetFilename]')
ERROR:es_client:Query: FROM auditbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.module == "file_integrity"
  AND event.action IN ("updated", "modified")
  AND (winlog.event_data.TargetFilename RLIKE ".*/etc/(ssh|pam\\.d|security|nginx|apache2|mysql).*"
       OR winlog.event_data.TargetFilename RLIKE ".*\\\\(inetpub|system32|config).*")
  AND host.name RLIKE ".*(cde|payment|prod).*"
| WHERE winlog.event_data.TargetUserName NOT IN ("ansible", "puppet", "chef", "saltstack")
| EVAL severity = "medium"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, winlog.event_data.TargetFilename, event.action, file.hash.sha256, severity
ERROR:rule_engine:Query execution failed for rule: System Configuration Change Without Approval
INFO:rule_engine:Executing rule: Unapproved Software Installation
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE (winlog.event_data.N...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.102s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:13: Unknown column [process.args]')
ERROR:es_client:Query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE (winlog.event_data.NewProcessName IN ("yum", "apt", "dpkg", "rpm", "msiexec.exe")
        AND process.args RLIKE ".*(install|add|setup).*")
    OR event.code == "11707"
| WHERE host.name RLIKE ".*(cde|payment|prod).*"
  AND winlog.event_data.TargetUserName NOT IN ("ansible", "puppet", "sccm-agent")
| EVAL severity = "medium"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, process.args, event.code, severity
ERROR:rule_engine:Query execution failed for rule: Unapproved Software Installation
INFO:rule_engine:Executing rule: Non-Standard Protocol on Payment Service Port
INFO:es_client:Executing ES|QL query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE winlog.event_data.DestPort IN (44...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.206s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 3:9: Unknown column [winlog.event_data.DestPort]\nline 4:7: Unknown column [winlog.event_data.Protocol]')
ERROR:es_client:Query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE winlog.event_data.DestPort IN (443, 8443, 8444, 9443)
  AND winlog.event_data.Protocol NOT IN ("tls", "https")
  AND host.name RLIKE ".*(payment|gateway|pos).*"
| STATS 
    packet_count = COUNT(*),
    protocols_seen = VALUES(winlog.event_data.Protocol)
  BY winlog.event_data.IpAddress, winlog.event_data.DestAddress, winlog.event_data.DestPort, host.name
| WHERE packet_count >= 5
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.IpAddress, winlog.event_data.DestAddress, winlog.event_data.DestPort, winlog.event_data.Protocol, protocols_seen, packet_count, severity
ERROR:rule_engine:Query execution failed for rule: Non-Standard Protocol on Payment Service Port
INFO:rule_engine:Executing rule: Weak TLS Version Detected (TLS 1.0/1.1)
INFO:es_client:Executing ES|QL query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE tls.version_protocol IN ("tls", "...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.208s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 3 problems\nline 3:9: Unknown column [tls.version_protocol]\nline 4:7: Unknown column [tls.version]\nline 5:7: Unknown column [winlog.event_data.DestPort]')
ERROR:es_client:Query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE tls.version_protocol IN ("tls", "ssl")
  AND tls.version RLIKE ".*(1\\.0|1\\.1|SSLv[23]).*"
  AND winlog.event_data.DestPort IN (443, 8443, 9443)
| STATS 
    connection_count = COUNT(*),
    tls_versions = VALUES(tls.version)
  BY winlog.event_data.IpAddress, winlog.event_data.DestAddress, host.name
| WHERE connection_count >= 1
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.IpAddress, winlog.event_data.DestAddress, tls.version, tls_versions, connection_count, severity
ERROR:rule_engine:Query execution failed for rule: Weak TLS Version Detected (TLS 1.0/1.1)
INFO:rule_engine:Executing rule: Multiple Failed Login Attempts (Brute Force) - Windows
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE event.category == "aut...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.202s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [event.category], did you mean [event.outcome]?')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE event.category == "authentication" 
  AND event.outcome == "failure"
| STATS failed_attempts = COUNT(*) BY winlog.event_data.IpAddress, winlog.event_data.TargetUserName, host.name
| WHERE failed_attempts >= 5
| EVAL severity = "medium"
| KEEP @timestamp, winlog.event_data.IpAddress, winlog.event_data.TargetUserName, host.name, failed_attempts, severity
ERROR:rule_engine:Query execution failed for rule: Multiple Failed Login Attempts (Brute Force) - Windows
INFO:rule_engine:Executing rule: Multiple Failed Login Attempts (Brute Force)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE event.category == "aut...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.202s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [event.category], did you mean [event.outcome]?')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE event.category == "authentication" 
  AND event.outcome == "failure"
| STATS failed_attempts = COUNT(*) BY winlog.event_data.IpAddress, winlog.event_data.TargetUserName, host.name
| WHERE failed_attempts >= 5
| EVAL severity = "medium"
| KEEP @timestamp, winlog.event_data.IpAddress, winlog.event_data.TargetUserName, host.name, failed_attempts, severity
ERROR:rule_engine:Query execution failed for rule: Multiple Failed Login Attempts (Brute Force)
INFO:rule_engine:Executing rule: Admin Login from Unusual Host - Windows
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.category == "au...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [event.category], did you mean [event.outcome]?')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.category == "authentication" 
  AND event.outcome == "success"
  AND (winlog.event_data.TargetUserName RLIKE ".*admin.*" OR winlog.event_data.TargetUserName IN ("root", "administrator", "sysadmin"))
| STATS current_hosts = VALUES(host.name) BY winlog.event_data.TargetUserName, winlog.event_data.IpAddress
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.TargetUserName, winlog.event_data.IpAddress, current_hosts, severity
ERROR:rule_engine:Query execution failed for rule: Admin Login from Unusual Host - Windows
INFO:rule_engine:Executing rule: Admin Login from Unusual Host
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.category == "au...
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:15] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:15] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:15] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:15] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:15] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:15] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.053s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [event.category], did you mean [event.outcome]?')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.category == "authentication" 
  AND event.outcome == "success"
  AND (winlog.event_data.TargetUserName RLIKE ".*admin.*" OR winlog.event_data.TargetUserName IN ("root", "administrator", "sysadmin"))
| STATS current_hosts = VALUES(host.name) BY winlog.event_data.TargetUserName, winlog.event_data.IpAddress
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.TargetUserName, winlog.event_data.IpAddress, current_hosts, severity
ERROR:rule_engine:Query execution failed for rule: Admin Login from Unusual Host
INFO:rule_engine:Executing rule: Successful Login After Multiple Failures - Windows
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.category == "au...
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.165s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:15] "GET /api/stats HTTP/1.1" 200 -
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.149s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [event.category], did you mean [event.outcome]?')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.category == "authentication"
| STATS 
    failures = COUNT_IF(event.outcome == "failure"),
    successes = COUNT_IF(event.outcome == "success"),
    max_time = MAX(@timestamp)
  BY winlog.event_data.IpAddress, winlog.event_data.TargetUserName, host.name
| WHERE failures >= 3 AND successes >= 1
| EVAL severity = "high"
| KEEP max_time, winlog.event_data.IpAddress, winlog.event_data.TargetUserName, host.name, failures, successes, severity
ERROR:rule_engine:Query execution failed for rule: Successful Login After Multiple Failures - Windows
INFO:rule_engine:Executing rule: Successful Login After Multiple Failures
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.category == "au...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.205s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [event.category], did you mean [event.outcome]?')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.category == "authentication"
| STATS 
    failures = COUNT_IF(event.outcome == "failure"),
    successes = COUNT_IF(event.outcome == "success"),
    max_time = MAX(@timestamp)
  BY winlog.event_data.IpAddress, winlog.event_data.TargetUserName, host.name
| WHERE failures >= 3 AND successes >= 1
| EVAL severity = "high"
| KEEP max_time, winlog.event_data.IpAddress, winlog.event_data.TargetUserName, host.name, failures, successes, severity
ERROR:rule_engine:Query execution failed for rule: Successful Login After Multiple Failures
INFO:rule_engine:Executing rule: Concurrent Logins from Different IPs - Windows
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 1 hour
| WHERE event.category == "authen...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [event.category], did you mean [event.outcome]?')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 1 hour
| WHERE event.category == "authentication" AND event.outcome == "success"
| WHERE source.geo.location IS NOT NULL
| STATS 
    locations = VALUES(source.geo.location),
    countries = VALUES(source.geo.country_name),
    time_span = MAX(@timestamp) - MIN(@timestamp)
  BY winlog.event_data.TargetUserName
| WHERE LENGTH(countries) >= 2 AND time_span < 3600000
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.TargetUserName, countries, locations, time_span, severity
ERROR:rule_engine:Query execution failed for rule: Concurrent Logins from Different IPs - Windows
INFO:rule_engine:Executing rule: Concurrent Logins from Impossible Locations
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 1 hour
| WHERE event.category == "authen...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [event.category], did you mean [event.outcome]?')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 1 hour
| WHERE event.category == "authentication" AND event.outcome == "success"
| WHERE source.geo.location IS NOT NULL
| STATS 
    locations = VALUES(source.geo.location),
    countries = VALUES(source.geo.country_name),
    time_span = MAX(@timestamp) - MIN(@timestamp)
  BY winlog.event_data.TargetUserName
| WHERE LENGTH(countries) >= 2 AND time_span < 3600000
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.TargetUserName, countries, locations, time_span, severity
ERROR:rule_engine:Query execution failed for rule: Concurrent Logins from Impossible Locations
INFO:rule_engine:Executing rule: Sudoers File Modified
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE winlog.event_data.Targe...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.061s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [winlog.event_data.TargetFilename]')
ERROR:es_client:Query: FROM auditbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE winlog.event_data.TargetFilename RLIKE ".*/etc/sudoers.*" 
  AND (event.action IN ("modified", "created", "deleted") 
       OR event.type == "change")
| EVAL severity = "high"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, winlog.event_data.TargetFilename, event.action, winlog.event_data.NewProcessName, severity
ERROR:rule_engine:Query execution failed for rule: Sudoers File Modified
INFO:rule_engine:Executing rule: Multiple Users Logged from Same Source IP
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE event.category == "aut...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.347s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [event.category], did you mean [event.outcome]?')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE event.category == "authentication" AND event.outcome == "success"
| STATS unique_users = COUNT_DISTINCT(winlog.event_data.TargetUserName) BY winlog.event_data.IpAddress, host.name
| WHERE unique_users >= 5
| EVAL severity = "medium"
| KEEP @timestamp, winlog.event_data.IpAddress, host.name, unique_users, severity
ERROR:rule_engine:Query execution failed for rule: Multiple Users Logged from Same Source IP
INFO:rule_engine:Executing rule: Suspicious Service Creation (Persistence)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.code == "7045"
| WHERE winl...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.204s]
INFO:rule_engine:Executing rule: Scheduled Task Created with SYSTEM Privileges
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.code == "4698"
| WHERE winl...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.408s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:9: Unknown column [winlog.event_data.TaskContent], did you mean [winlog.event_data.SubjectUserName]?')
ERROR:es_client:Query: FROM winlogbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.code == "4698"
| WHERE winlog.event_data.TaskContent RLIKE ".*<UserId>S-1-5-18</UserId>.*"
    OR winlog.event_data.TaskContent RLIKE ".*<UserId>SYSTEM</UserId>.*"
| EVAL severity = "high"
| KEEP @timestamp, host.name, winlog.event_data.TaskName, winlog.event_data.SubjectUserName, winlog.event_data.TaskContent, severity
ERROR:rule_engine:Query execution failed for rule: Scheduled Task Created with SYSTEM Privileges
INFO:rule_engine:Executing rule: Configuration File Modified (Unauthorized)
INFO:es_client:Executing ES|QL query: FROM auditbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.module == "file_integrity"
 ...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.205s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'parsing_exception', 'line 4:46: token recognition error at: \'".*(\\.\'')
ERROR:es_client:Query: FROM auditbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.module == "file_integrity"
  AND winlog.event_data.TargetFilename RLIKE ".*(\.conf|\.config|\.ini|\.yaml|\.yml|\.xml)$"
  AND winlog.event_data.TargetFilename RLIKE ".*(etc|config|nginx|apache|mysql).*"
  AND event.action IN ("updated", "created")
| EVAL severity = "high"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, winlog.event_data.TargetFilename, event.action, file.hash.sha256, severity
ERROR:rule_engine:Query execution failed for rule: Configuration File Modified (Unauthorized)
INFO:rule_engine:Executing rule: Password Policy Changed
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.code IN ("4713", "4739", "4...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 5:112: Unknown column [winlog.event_data.DomainPolicyChanged], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.SubjectUserName]?')
ERROR:es_client:Query: FROM winlogbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.code IN ("4713", "4739", "4670")
| EVAL severity = "high"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, event.code, winlog.event_data.SubjectUserName, winlog.event_data.DomainPolicyChanged, severity
ERROR:rule_engine:Query execution failed for rule: Password Policy Changed
INFO:rule_engine:Executing rule: Ransomware Indicator Chain (File Rename + Encryption)
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE event.action IN ("ren...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.409s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:7: Unknown column [winlog.event_data.TargetFilename], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword]?')
ERROR:es_client:Query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE event.action IN ("renamed", "created", "file_rename")
  AND winlog.event_data.TargetFilename RLIKE ".*\\.(encrypted|locked|crypted|crypt|enc|locky|cerber)$"
| STATS renamed_count = COUNT(*) BY winlog.event_data.TargetUserName, host.name
| WHERE renamed_count >= 10
| EVAL severity = "critical"
| KEEP @timestamp, winlog.event_data.TargetUserName, host.name, renamed_count, severity
ERROR:rule_engine:Query execution failed for rule: Ransomware Indicator Chain (File Rename + Encryption)
INFO:rule_engine:Executing rule: Lateral Movement Pattern Detected
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.category == "au...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.198s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [event.category], did you mean any of [event.action, event.outcome, event.action.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.category == "authentication" AND event.outcome == "success"
  AND event.action IN ("logon", "network_logon")
| STATS unique_destinations = COUNT_DISTINCT(winlog.event_data.DestAddress) BY winlog.event_data.TargetUserName, winlog.event_data.IpAddress
| WHERE unique_destinations >= 5
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.TargetUserName, winlog.event_data.IpAddress, unique_destinations, severity
ERROR:rule_engine:Query execution failed for rule: Lateral Movement Pattern Detected
INFO:rule_engine:Executing rule: Emergency Breach Response Trigger (Multi-Signal)
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, metricbeat-*, filebeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| ...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.108s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 4:64: Unknown column [network.bytes]\nline 5:9: Unknown column [winlog.event_data.TargetFilename], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword, winlog.event_data.NewProcessName, winlog.event_data.NewProcessName.keyword]?')
ERROR:es_client:Query: FROM auditbeat-*, metricbeat-*, filebeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE (event.code == "1102")
    OR (winlog.event_data.NewProcessName IN ("zip", "tar") AND network.bytes > 10485760)
    OR (winlog.event_data.TargetFilename RLIKE ".*\\.(encrypted|locked)$" AND event.action == "renamed")
    OR (event.action == "stopped-service" AND winlog.event_data.NewProcessName RLIKE ".*(audit|elastic-agent).*")
    OR (winlog.event_data.TargetUserName RLIKE ".*admin.*" AND event.outcome == "failure" AND event.category == "authentication")
| STATS 
    critical_signals = COUNT_DISTINCT(event.action),
    hosts_affected = COUNT_DISTINCT(host.name),
    users_involved = VALUES(winlog.event_data.TargetUserName)
  BY host.name
| WHERE critical_signals >= 2
| EVAL severity = "critical"
| KEEP @timestamp, host.name, critical_signals, hosts_affected, users_involved, severity
ERROR:rule_engine:Query execution failed for rule: Emergency Breach Response Trigger (Multi-Signal)
INFO:rule_engine:Executing rule: Certificate Expiration Imminent
INFO:es_client:Executing ES|QL query: FROM metricbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 24 hours
| WHERE tls.server.x509.not_aft...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.102s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [tls.server.x509.not_after]')
ERROR:es_client:Query: FROM metricbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 24 hours
| WHERE tls.server.x509.not_after IS NOT NULL
| EVAL days_until_expiry = (tls.server.x509.not_after - NOW()) / 86400000
| WHERE days_until_expiry <= 7 AND days_until_expiry >= 0
| EVAL severity = "medium"
| KEEP @timestamp, tls.server.x509.subject.common_name, tls.server.x509.not_after, days_until_expiry, winlog.event_data.DestAddress, severity
ERROR:rule_engine:Query execution failed for rule: Certificate Expiration Imminent
INFO:rule_engine:Executing rule: UAC Bypass Attempt Detected
INFO:es_client:Executing ES|QL query: FROM filebeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE (winlog.event_data.New...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.206s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:10: Unknown column [winlog.event_data.NewProcessName]')
ERROR:es_client:Query: FROM filebeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE (winlog.event_data.NewProcessName == "sudo" OR message RLIKE ".*sudo:.*COMMAND.*")
| WHERE winlog.event_data.TargetUserName NOT IN ("sysadmin", "root", "ansible", "puppet")
| STATS sudo_count = COUNT(*) BY winlog.event_data.TargetUserName, host.name, process.args
| WHERE sudo_count >= 1
| EVAL severity = "medium"
| KEEP @timestamp, winlog.event_data.TargetUserName, host.name, process.args, sudo_count, severity
ERROR:rule_engine:Query execution failed for rule: UAC Bypass Attempt Detected
INFO:rule_engine:Executing rule: Archive Tool Usage Followed by Network Transfer
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, metricbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE winlog....
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.205s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 4:8: Unknown column [winlog.event_data.Protocol], did you mean any of [winlog.event_data.NewProcessName, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName.keyword, winlog.event_data.TargetUserName.keyword]?\nline 4:67: Unknown column [network.bytes]')
ERROR:es_client:Query: FROM auditbeat-*, metricbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE winlog.event_data.NewProcessName IN ("zip", "tar", "7z", "rar", "gzip", "7z.exe", "WinRAR.exe")
    OR winlog.event_data.Protocol IN ("http", "https", "ftp") AND network.bytes > 1048576
| STATS 
    archive_count = COUNT_IF(winlog.event_data.NewProcessName IN ("zip", "tar", "7z", "rar")),
    network_count = COUNT_IF(winlog.event_data.Protocol IS NOT NULL),
    total_bytes = SUM(network.bytes)
  BY winlog.event_data.TargetUserName, host.name
| WHERE archive_count >= 1 AND network_count >= 1
| EVAL severity = "critical"
| KEEP @timestamp, winlog.event_data.TargetUserName, host.name, archive_count, network_count, total_bytes, severity
ERROR:rule_engine:Query execution failed for rule: Archive Tool Usage Followed by Network Transfer
INFO:rule_engine:Executing rule: Unusual DNS Query Volume (Tunneling Indicator)
INFO:es_client:Executing ES|QL query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE winlog.event_data.Protocol == "dns...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 3:9: Unknown column [winlog.event_data.Protocol]\nline 3:48: Unknown column [winlog.event_data.DestPort]')
ERROR:es_client:Query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE winlog.event_data.Protocol == "dns" OR winlog.event_data.DestPort == 53
| STATS 
    dns_count = COUNT(*),
    unique_domains = COUNT_DISTINCT(winlog.event_data.QueryName)
  BY winlog.event_data.IpAddress, host.name
| WHERE dns_count >= 100
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.IpAddress, host.name, dns_count, unique_domains, severity
ERROR:rule_engine:Query execution failed for rule: Unusual DNS Query Volume (Tunneling Indicator)
INFO:rule_engine:Executing rule: USB Mass Storage Device Connected
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE (event.code == "2003...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.207s]
INFO:rule_engine:Executing rule: Email with Large Attachments to External Domain
INFO:es_client:Executing ES|QL query: FROM filebeat-*, metricbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE (winlog.event_data.Pr...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.200s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 3:10: Unknown column [winlog.event_data.Protocol]\nline 3:51: Unknown column [network.bytes]')
ERROR:es_client:Query: FROM filebeat-*, metricbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE (winlog.event_data.Protocol == "smtp" AND network.bytes > 10485760)
    OR (message RLIKE ".*attachment.*size.*" AND message RLIKE ".*external.*")
| WHERE destination.domain NOT IN ("company.com", "company.net")
| EVAL severity = "medium"
| KEEP @timestamp, winlog.event_data.TargetUserName, winlog.event_data.IpAddress, destination.domain, network.bytes, severity
ERROR:rule_engine:Query execution failed for rule: Email with Large Attachments to External Domain
INFO:rule_engine:Executing rule: Critical Service Down (Heartbeat Alert)
INFO:es_client:Executing ES|QL query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE monitor.status == "down"
  AND mon...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.203s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 3:9: Unknown column [monitor.status]\nline 4:7: Unknown column [monitor.name], did you mean [host.name]?')
ERROR:es_client:Query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE monitor.status == "down"
  AND monitor.name IN ("database-prod", "web-app", "api-gateway", "auth-service")
| STATS down_duration = MAX(@timestamp) - MIN(@timestamp) BY monitor.name, host.name
| WHERE down_duration >= 300000
| EVAL severity = "high"
| KEEP @timestamp, monitor.name, host.name, monitor.status, down_duration, severity
ERROR:rule_engine:Query execution failed for rule: Critical Service Down (Heartbeat Alert)
INFO:rule_engine:Executing rule: File Integrity Change in System Binaries
INFO:es_client:Executing ES|QL query: FROM auditbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.module == "file_integrity"
 ...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'parsing_exception', 'line 4:47: token recognition error at: \'".*(\\/\'')
ERROR:es_client:Query: FROM auditbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.module == "file_integrity"
  AND (winlog.event_data.TargetFilename RLIKE ".*(\/bin\/|\/sbin\/|Windows\\\\System32\\\\).*"
       OR winlog.event_data.TargetFilename RLIKE ".*\\.(exe|dll|so|dylib)$")
  AND event.action IN ("updated", "created", "attributes_modified")
| EVAL severity = "critical"
| KEEP @timestamp, host.name, winlog.event_data.TargetFilename, file.hash.sha256, event.action, winlog.event_data.TargetUserName, severity
ERROR:rule_engine:Query execution failed for rule: File Integrity Change in System Binaries
INFO:rule_engine:Executing rule: Unexpected System Reboot
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE (event.code == "1074"...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.079s]
INFO:rule_engine:Executing rule: Memory Exhaustion on Critical Host
INFO:es_client:Executing ES|QL query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE system.memory.actual.used.pct >= 0...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:1.356s]
INFO:rule_engine:Executing rule: Multiple Failed Login Attempts (Brute Force) - FIXED
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE event.code == "4625"
| STATS faile...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.196s]
INFO:rule_engine:Executing rule: Successful Login After Multiple Failures - FIXED
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.code IN ("4624", "4625")
| ...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.205s]
INFO:rule_engine:Executing rule: Login Outside Business Hours (High-Privilege Account)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.category == "au...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.207s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [event.category], did you mean [event.outcome]?')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.category == "authentication" AND event.outcome == "success"
| WHERE winlog.event_data.TargetUserName RLIKE ".*(admin|root|sysadmin).*"
| EVAL hour = DATE_EXTRACT(@timestamp, "hour")
| EVAL day_of_week = DATE_EXTRACT(@timestamp, "day_of_week")
| WHERE (hour < 6 OR hour >= 22) OR (day_of_week IN (6, 7))
| EVAL severity = "medium"
| KEEP @timestamp, winlog.event_data.TargetUserName, winlog.event_data.IpAddress, host.name, hour, day_of_week, severity
ERROR:rule_engine:Query execution failed for rule: Login Outside Business Hours (High-Privilege Account)
INFO:rule_engine:Executing rule: First-Time Login from New IP - Windows
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.category == "au...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.058s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [event.category], did you mean [event.outcome]?')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.category == "authentication" AND event.outcome == "success"
| WHERE source.geo.country_name IS NOT NULL
| STATS countries = VALUES(source.geo.country_name) BY winlog.event_data.TargetUserName
| WHERE LENGTH(countries) >= 2
| EVAL severity = "medium"
| KEEP @timestamp, winlog.event_data.TargetUserName, winlog.event_data.IpAddress, source.geo.country_name, countries, severity
ERROR:rule_engine:Query execution failed for rule: First-Time Login from New IP - Windows
INFO:rule_engine:Executing rule: First-Time Login from Geographic Location
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.category == "au...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.043s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [event.category], did you mean [event.outcome]?')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.category == "authentication" AND event.outcome == "success"
| WHERE source.geo.country_name IS NOT NULL
| STATS countries = VALUES(source.geo.country_name) BY winlog.event_data.TargetUserName
| WHERE LENGTH(countries) >= 2
| EVAL severity = "medium"
| KEEP @timestamp, winlog.event_data.TargetUserName, winlog.event_data.IpAddress, source.geo.country_name, countries, severity
ERROR:rule_engine:Query execution failed for rule: First-Time Login from Geographic Location
INFO:rule_engine:Executing rule: New Local Administrator Account Created
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*, filebeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE (event.c...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.035s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 3:35: Unknown column [winlog.event_data.MemberSid], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, winlog.event_data.NewProcessName.keyword, winlog.event_data.TargetUserName.keyword]?\nline 5:59: Unknown column [process.args]')
ERROR:es_client:Query: FROM winlogbeat-*, filebeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE (event.code == "4720" AND winlog.event_data.MemberSid RLIKE ".*-500") 
    OR (event.action == "added-user-account" AND winlog.event_data.TargetUserName RLIKE ".*(admin|root).*")
    OR (winlog.event_data.NewProcessName == "useradd" AND process.args RLIKE ".*-G (sudo|wheel|admin).*")
| EVAL severity = "high"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, event.action, winlog.event_data.NewProcessName, process.args, severity
ERROR:rule_engine:Query execution failed for rule: New Local Administrator Account Created
INFO:rule_engine:Executing rule: Sudo Command Executed by Non-Standard User
INFO:es_client:Executing ES|QL query: FROM filebeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE (winlog.event_data.New...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.044s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:10: Unknown column [winlog.event_data.NewProcessName]')
ERROR:es_client:Query: FROM filebeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE (winlog.event_data.NewProcessName == "sudo" OR message RLIKE ".*sudo:.*COMMAND.*")
| WHERE winlog.event_data.TargetUserName NOT IN ("sysadmin", "root", "ansible", "puppet")
| STATS sudo_count = COUNT(*) BY winlog.event_data.TargetUserName, host.name, process.args
| WHERE sudo_count >= 1
| EVAL severity = "medium"
| KEEP @timestamp, winlog.event_data.TargetUserName, host.name, process.args, sudo_count, severity
ERROR:rule_engine:Query execution failed for rule: Sudo Command Executed by Non-Standard User
INFO:rule_engine:Executing rule: Mass File Access in Sensitive Directories
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.action IN ("ac...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.051s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:8: Unknown column [winlog.event_data.TargetFilename], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword]?')
ERROR:es_client:Query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.action IN ("accessed", "read", "file_read")
  AND (winlog.event_data.TargetFilename RLIKE ".*(personal|confidential|hr|finance|customer).*" 
       OR winlog.event_data.TargetFilename RLIKE ".*Documents.*")
| STATS file_count = COUNT_DISTINCT(winlog.event_data.TargetFilename) BY winlog.event_data.TargetUserName, host.name
| WHERE file_count >= 50
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.TargetUserName, host.name, file_count, severity
ERROR:rule_engine:Query execution failed for rule: Mass File Access in Sensitive Directories
INFO:rule_engine:Executing rule: Correlated Incident - Access + Exfil + Tamper (30min)
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, metricbeat-*, filebeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 30 minutes
| ...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.069s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 3:64: Unknown column [winlog.event_data.TargetFilename], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword, winlog.event_data.NewProcessName, winlog.event_data.NewProcessName.keyword]?\nline 4:64: Unknown column [network.bytes]')
ERROR:es_client:Query: FROM auditbeat-*, metricbeat-*, filebeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 30 minutes
| WHERE (event.action IN ("accessed", "read", "file_read") AND winlog.event_data.TargetFilename RLIKE ".*sensitive.*")
    OR (winlog.event_data.NewProcessName IN ("zip", "tar") AND network.bytes > 1048576)
    OR (event.code IN ("1102", "4725") OR message RLIKE ".*(auditd.*stopped|log.*cleared).*")
| STATS 
    access_events = COUNT_IF(event.action IN ("accessed", "read")),
    exfil_events = COUNT_IF(winlog.event_data.NewProcessName IN ("zip", "tar")),
    tamper_events = COUNT_IF(event.code IN ("1102", "4725"))
  BY winlog.event_data.TargetUserName, host.name
| WHERE access_events >= 1 AND exfil_events >= 1 AND tamper_events >= 1
| EVAL severity = "critical"
| KEEP @timestamp, winlog.event_data.TargetUserName, host.name, access_events, exfil_events, tamper_events, severity
ERROR:rule_engine:Query execution failed for rule: Correlated Incident - Access + Exfil + Tamper (30min)
INFO:rule_engine:Executing rule: Personal Data Access Outside Authorized Systems
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.action IN ("ac...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.117s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:8: Unknown column [winlog.event_data.TargetFilename], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword]?')
ERROR:es_client:Query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE event.action IN ("accessed", "read", "opened")
  AND (winlog.event_data.TargetFilename RLIKE ".*(PII|personal|customer|GDPR|SSN|passport).*"
       OR message RLIKE ".*(SELECT.*FROM users|personal_data).*")
| WHERE host.name NOT IN ("data-warehouse-01", "crm-prod", "hr-system")
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.TargetUserName, host.name, winlog.event_data.TargetFilename, event.action, severity
ERROR:rule_engine:Query execution failed for rule: Personal Data Access Outside Authorized Systems
INFO:rule_engine:Executing rule: Data Retention Policy Violation (Old Data Accessed)
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 24 hours
| WHERE event.action IN ("access...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.192s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:7: Unknown column [winlog.event_data.TargetFilename]')
ERROR:es_client:Query: FROM auditbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 24 hours
| WHERE event.action IN ("accessed", "read")
  AND winlog.event_data.TargetFilename RLIKE ".*(archive|backup|old_data|20[0-1][0-7]).*"
| EVAL file_age_days = (@timestamp - file.created) / 86400000
| WHERE file_age_days > 2555
| EVAL severity = "medium"
| KEEP @timestamp, winlog.event_data.TargetUserName, winlog.event_data.TargetFilename, file.created, file_age_days, severity
ERROR:rule_engine:Query execution failed for rule: Data Retention Policy Violation (Old Data Accessed)
INFO:rule_engine:Executing rule: Auditd Service Stopped or Disabled
INFO:es_client:Executing ES|QL query: FROM filebeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE (message RLIKE ".*(audi...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.205s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 4:12: Unknown column [process.args]\nline 5:50: Unknown column [winlog.event_data.NewProcessName]')
ERROR:es_client:Query: FROM filebeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE (message RLIKE ".*(auditd.*stopped|audit.*disabled).*" 
        OR process.args RLIKE ".*(systemctl stop auditd|service auditd stop).*"
        OR event.action == "stopped-service" AND winlog.event_data.NewProcessName RLIKE ".*audit.*")
| EVAL severity = "critical"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, process.args, message, severity
ERROR:rule_engine:Query execution failed for rule: Auditd Service Stopped or Disabled
INFO:rule_engine:Executing rule: Windows Event Log Cleared (Event 1102)
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE event.code == "1102"
| EVAL severi...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.214s]
INFO:rule_engine:Executing rule: Log File Deletion in Critical Paths
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.action IN ("de...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.189s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:8: Unknown column [winlog.event_data.TargetFilename], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword, winlog.event_data.NewProcessName, winlog.event_data.NewProcessName.keyword]?')
ERROR:es_client:Query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.action IN ("deleted", "file_deletion") 
  AND (winlog.event_data.TargetFilename RLIKE ".*/var/log/.*" OR winlog.event_data.TargetFilename RLIKE ".*Windows.*winevt.*Logs.*")
| EVAL severity = "high"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, winlog.event_data.TargetFilename, winlog.event_data.NewProcessName, event.action, severity
ERROR:rule_engine:Query execution failed for rule: Log File Deletion in Critical Paths
INFO:rule_engine:Executing rule: Elastic Agent/Beat Stopped Unexpectedly
INFO:es_client:Executing ES|QL query: FROM metricbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE (monitor.status == "do...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 3 problems\nline 3:10: Unknown column [monitor.status]\nline 3:39: Unknown column [monitor.name], did you mean [host.name]?\nline 4:63: Unknown column [event.action]')
ERROR:es_client:Query: FROM metricbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE (monitor.status == "down" AND monitor.name RLIKE ".*(elastic-agent|filebeat|winlogbeat).*")
    OR (message RLIKE ".*(elastic-agent|beat).*stopped.*" AND event.action == "stopped-service")
| STATS down_count = COUNT(*) BY host.name, monitor.name
| WHERE down_count >= 1
| EVAL severity = "high"
| KEEP @timestamp, host.name, monitor.name, monitor.status, down_count, severity
ERROR:rule_engine:Query execution failed for rule: Elastic Agent/Beat Stopped Unexpectedly
INFO:rule_engine:Executing rule: Syslog Service Interruption
INFO:es_client:Executing ES|QL query: FROM filebeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE (message RLIKE ".*(rsys...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:12: Unknown column [process.args]')
ERROR:es_client:Query: FROM filebeat-*, auditbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE (message RLIKE ".*(rsyslogd|syslog).*stopped.*" 
        OR process.args RLIKE ".*(systemctl stop rsyslog|service rsyslog stop).*")
| EVAL severity = "high"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, process.args, message, severity
ERROR:rule_engine:Query execution failed for rule: Syslog Service Interruption
INFO:rule_engine:Executing rule: Log Rotation Policy Modified
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE winlog.event_data.Targ...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 3:9: Unknown column [winlog.event_data.TargetFilename]')
ERROR:es_client:Query: FROM auditbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE winlog.event_data.TargetFilename RLIKE ".*/etc/logrotate.*" 
  AND event.action IN ("modified", "created", "deleted")
| EVAL severity = "medium"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, winlog.event_data.TargetFilename, event.action, winlog.event_data.NewProcessName, severity
ERROR:rule_engine:Query execution failed for rule: Log Rotation Policy Modified
INFO:rule_engine:Executing rule: Mass Deletion of Log Files
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE event.action IN ("del...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:8: Unknown column [winlog.event_data.TargetFilename], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword]?')
ERROR:es_client:Query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE event.action IN ("deleted", "file_deletion")
  AND (winlog.event_data.TargetFilename RLIKE ".*\\.log$" OR file.extension == "log" OR file.extension == "evtx")
| STATS deleted_count = COUNT(*) BY winlog.event_data.TargetUserName, host.name
| WHERE deleted_count >= 10
| EVAL severity = "critical"
| KEEP @timestamp, winlog.event_data.TargetUserName, host.name, deleted_count, severity
ERROR:rule_engine:Query execution failed for rule: Mass Deletion of Log Files
INFO:rule_engine:Executing rule: Auditd Rules Modified or Deleted
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE (winlog.event_data.Targ...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.275s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 3 problems\nline 3:10: Unknown column [winlog.event_data.TargetFilename]\nline 4:9: Unknown column [winlog.event_data.NewProcessName]\nline 4:60: Unknown column [process.args]')
ERROR:es_client:Query: FROM auditbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE (winlog.event_data.TargetFilename RLIKE ".*/etc/audit/.*" AND event.action IN ("modified", "deleted"))
    OR (winlog.event_data.NewProcessName == "auditctl" AND process.args RLIKE ".* -D .*")
| EVAL severity = "critical"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, winlog.event_data.TargetFilename, winlog.event_data.NewProcessName, process.args, event.action, severity
ERROR:rule_engine:Query execution failed for rule: Auditd Rules Modified or Deleted
INFO:rule_engine:Executing rule: Disk Space Critical on Log Storage
INFO:es_client:Executing ES|QL query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE system.filesystem.mount_point RLIK...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.133s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:24: Cannot use field [system.filesystem.used.pct] due to ambiguities being mapped as [2] incompatible types: [float] in [metricbeat-2026.01.28, metricbeat-2026.01.31, metricbeat-2026.02.01], [long] in [metricbeat-2026.01.16, metricbeat-2026.01.29, metricbeat-2026.01.30] and [1] other index')
ERROR:es_client:Query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE system.filesystem.mount_point RLIKE ".*(var|log|audit).*"
| EVAL disk_used_pct = system.filesystem.used.pct * 100
| WHERE disk_used_pct >= 90
| EVAL severity = "high"
| KEEP @timestamp, host.name, system.filesystem.mount_point, disk_used_pct, severity
ERROR:rule_engine:Query execution failed for rule: Disk Space Critical on Log Storage
INFO:rule_engine:Executing rule: Disabled Account Login Attempt
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.code == "4625" 
  AND (winl...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:8: Unknown column [winlog.event_data.SubStatusCode], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.IpAddress, winlog.event_data.IpAddress.keyword, winlog.event_data.TargetUserName.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.code == "4625" 
  AND (winlog.event_data.SubStatusCode == "0xC0000072" 
       OR winlog.event_data.SubStatusCode == "0xC0000234")
| STATS attempt_count = COUNT(*) BY winlog.event_data.TargetUserName, winlog.event_data.IpAddress, host.name
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.TargetUserName, winlog.event_data.IpAddress, host.name, attempt_count, severity
ERROR:rule_engine:Query execution failed for rule: Disabled Account Login Attempt
INFO:rule_engine:Executing rule: Data Breach Indicators Aggregated (High Severity)
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, metricbeat-*, filebeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 1 hour
| WHER...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 5:12: Unknown column [winlog.event_data.TargetFilename], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword, winlog.event_data.NewProcessName, winlog.event_data.NewProcessName.keyword]?')
ERROR:es_client:Query: FROM auditbeat-*, metricbeat-*, filebeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 1 hour
| WHERE (event.code IN ("4720", "4732", "1102") 
        OR winlog.event_data.NewProcessName IN ("zip", "tar", "mysqldump")
        OR winlog.event_data.TargetFilename RLIKE ".*\\.(encrypted|log)$" AND event.action == "deleted"
        OR event.outcome == "failure" AND event.category == "authentication")
	| STATS 
    rule_count = COUNT(*),
    event_categories = VALUES(event.category)
  BY winlog.event_data.TargetUserName, host.name
| WHERE rule_count >= 3
| EVAL severity = "critical"
| KEEP @timestamp, winlog.event_data.TargetUserName, host.name, rule_count, event_categories, severity
ERROR:rule_engine:Query execution failed for rule: Data Breach Indicators Aggregated (High Severity)
INFO:rule_engine:Executing rule: Database Bulk Export Detected
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE winlog.event_data.NewP...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.614s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 3:9: Unknown column [winlog.event_data.NewProcessName]\nline 4:8: Unknown column [process.args]')
ERROR:es_client:Query: FROM auditbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE winlog.event_data.NewProcessName IN ("mysqldump", "pg_dump", "mongodump", "sqlcmd", "psql")
    OR process.args RLIKE ".*(SELECT.*FROM|COPY.*TO|BACKUP DATABASE).*"
| EVAL severity = "high"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, process.args, severity
ERROR:rule_engine:Query execution failed for rule: Database Bulk Export Detected
INFO:rule_engine:Executing rule: Windows Administrators Group Membership Change
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.code IN ("4732", "4733") 
 ...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.409s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 7:31: Unknown column [winlog.event_data.MemberName], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.SubjectUserName, winlog.event_data.TargetUserName.keyword, winlog.event_data.SubjectUserName.keyword]?')
ERROR:es_client:Query: FROM winlogbeat-*
| WHERE @timestamp >= NOW() - 10 minutes
| WHERE event.code IN ("4732", "4733") 
  AND winlog.event_data.TargetUserName == "Administrators"
| EVAL action = CASE(event.code == "4732", "added", event.code == "4733", "removed")
| EVAL severity = "high"
| KEEP @timestamp, host.name, winlog.event_data.MemberName, action, winlog.event_data.SubjectUserName, severity
ERROR:rule_engine:Query execution failed for rule: Windows Administrators Group Membership Change
INFO:rule_engine:Executing rule: Large Outbound Data Transfer to Rare Destination
INFO:es_client:Executing ES|QL query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE network.direction == "outbound" O...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 3:9: Unknown column [network.direction]\nline 3:44: Unknown column [winlog.event_data.IpAddress]')
ERROR:es_client:Query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE network.direction == "outbound" OR winlog.event_data.IpAddress RLIKE "^10\\.|^172\\.16\\.|^192\\.168\\."
| STATS total_bytes = SUM(network.bytes) BY winlog.event_data.DestAddress, winlog.event_data.IpAddress, host.name
| WHERE total_bytes >= 104857600
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.IpAddress, winlog.event_data.DestAddress, destination.geo.country_name, host.name, total_bytes, severity
ERROR:rule_engine:Query execution failed for rule: Large Outbound Data Transfer to Rare Destination
INFO:rule_engine:Executing rule: Cloud Storage Sync Tools on Unauthorized Hosts
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE winlog.event_data.Ne...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.308s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:8: Unknown column [winlog.event_data.TargetFilename], did you mean any of [winlog.event_data.TargetUserName, winlog.event_data.TargetUserName.keyword, winlog.event_data.NewProcessName, winlog.event_data.NewProcessName.keyword]?')
ERROR:es_client:Query: FROM auditbeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE winlog.event_data.NewProcessName RLIKE ".*(dropbox|googledrive|onedrive|box|mega).*"
    OR winlog.event_data.TargetFilename RLIKE ".*(Dropbox|Google Drive|OneDrive).*"
| WHERE host.name NOT IN ("approved-workstation-001", "approved-workstation-002")
| EVAL severity = "medium"
| KEEP @timestamp, host.name, winlog.event_data.TargetUserName, winlog.event_data.NewProcessName, winlog.event_data.TargetFilename, severity
ERROR:rule_engine:Query execution failed for rule: Cloud Storage Sync Tools on Unauthorized Hosts
INFO:rule_engine:Executing rule: Database Integrity Check Failure
INFO:es_client:Executing ES|QL query: FROM filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE message RLIKE ".*(integrity check f...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.100s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 4:9: Unknown column [winlog.event_data.NewProcessName]')
ERROR:es_client:Query: FROM filebeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE message RLIKE ".*(integrity check failed|corruption detected|checksum mismatch).*"
    OR (winlog.event_data.NewProcessName IN ("mysqlcheck", "pg_checksums") AND message RLIKE ".*error.*")
| EVAL severity = "critical"
| KEEP @timestamp, host.name, message, winlog.event_data.NewProcessName, severity
ERROR:rule_engine:Query execution failed for rule: Database Integrity Check Failure
INFO:rule_engine:Executing rule: Multiple GDPR-Relevant Events from Same User
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, metricbeat-*, filebeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 1 hour
| WHER...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.204s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 1 problem\nline 10:8: Unknown column [@timestamp]')
ERROR:es_client:Query: FROM auditbeat-*, metricbeat-*, filebeat-*, winlogbeat-*
| WHERE @timestamp >= NOW() - 1 hour
| WHERE event.category IN ("authentication", "file", "process", "network")
  AND (event.outcome == "failure" 
       OR event.action IN ("accessed", "modified", "deleted", "created")
       OR winlog.event_data.NewProcessName IN ("sudo", "runas", "net"))
| STATS event_types = COUNT_DISTINCT(event.action) BY winlog.event_data.TargetUserName, host.name
| WHERE event_types >= 5
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.TargetUserName, host.name, event_types, severity
ERROR:rule_engine:Query execution failed for rule: Multiple GDPR-Relevant Events from Same User
INFO:rule_engine:Executing rule: Unauthorized Data Processing Activity
INFO:es_client:Executing ES|QL query: FROM auditbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 30 minutes
| WHERE (winlog.event_data.New...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.203s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 3 problems\nline 3:10: Unknown column [winlog.event_data.NewProcessName]\nline 4:13: Unknown column [process.args]\nline 5:9: Unknown column [winlog.event_data.TargetFilename]')
ERROR:es_client:Query: FROM auditbeat-*, filebeat-*
| WHERE @timestamp >= NOW() - 30 minutes
| WHERE (winlog.event_data.NewProcessName IN ("python", "perl", "ruby", "node", "powershell.exe", "cmd.exe")
        AND process.args RLIKE ".*(SELECT|INSERT|UPDATE|DELETE).*")
    OR (winlog.event_data.TargetFilename RLIKE ".*\\.(csv|xlsx|json).*" AND event.action == "created" 
        AND file.size > 10485760)
| WHERE winlog.event_data.TargetUserName NOT IN ("etl-service", "data-pipeline", "reporting-service")
| STATS activity_count = COUNT(*) BY winlog.event_data.TargetUserName, host.name, winlog.event_data.NewProcessName
| WHERE activity_count >= 5
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.TargetUserName, host.name, winlog.event_data.NewProcessName, activity_count, severity
ERROR:rule_engine:Query execution failed for rule: Unauthorized Data Processing Activity
INFO:rule_engine:Executing rule: Windows Event Log Cleared - FIXED
INFO:es_client:Executing ES|QL query: FROM winlogbeat-*
| WHERE @timestamp >= NOW() - 5 minutes
| WHERE event.code == "1102"
| EVAL severi...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:200 duration:0.206s]
INFO:rule_engine:Executing rule: Cross-Border Data Transfer Detected
INFO:es_client:Executing ES|QL query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE network.direction == "outbound" O...
INFO:elastic_transport.transport:POST http://139.28.47.17:9908/_query [status:400 duration:0.207s]
ERROR:es_client:Error executing ES|QL query: BadRequestError(400, 'verification_exception', 'Found 2 problems\nline 3:9: Unknown column [network.direction]\nline 3:44: Unknown column [winlog.event_data.IpAddress]')
ERROR:es_client:Query: FROM metricbeat-*
| WHERE @timestamp >= NOW() - 15 minutes
| WHERE network.direction == "outbound" OR winlog.event_data.IpAddress RLIKE "^10\\.|^172\\.16\\.|^192\\.168\\."
| WHERE destination.geo.country_iso_code NOT IN ("AT", "BE", "BG", "HR", "CY", "CZ", "DK", "EE", "FI", "FR", "DE", "GR", "HU", "IE", "IT", "LV", "LT", "LU", "MT", "NL", "PL", "PT", "RO", "SK", "SI", "ES", "SE", "IS", "LI", "NO")
| STATS total_bytes = SUM(network.bytes) BY destination.geo.country_name, winlog.event_data.DestAddress, winlog.event_data.TargetUserName
| WHERE total_bytes > 10485760
| EVAL severity = "high"
| KEEP @timestamp, winlog.event_data.TargetUserName, winlog.event_data.DestAddress, destination.geo.country_name, total_bytes, severity
ERROR:rule_engine:Query execution failed for rule: Cross-Border Data Transfer Detected
INFO:rule_engine:Execution complete: {'total_rules': 171, 'executed': 171, 'failed': 0, 'alerts_generated': 2}
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:27] "POST /api/execute HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:31] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:31] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:31] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:31] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:31] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:31] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.374s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:31] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:32] "GET /api/alerts/alert_2 HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:45] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:45] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:45] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:45] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:45] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:45] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.275s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:45] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:10:48] "GET /api/alerts/alert_1 HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:11:15] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:11:15] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:11:15] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:11:15] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:11:15] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:11:15] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.185s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:11:16] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:11:45] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:11:45] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:11:45] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:11:45] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:11:45] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:11:45] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.376s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:11:46] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:12:15] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:12:15] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:12:15] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:12:15] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:12:15] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:12:15] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.362s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:12:16] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:12:45] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:12:45] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:12:45] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:12:45] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:12:45] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:12:45] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.805s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:12:46] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:13:15] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:13:15] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:13:15] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:13:15] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:13:15] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:13:15] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.580s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:13:16] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:13:46] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:13:46] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:13:46] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:13:46] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:13:46] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:13:46] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.202s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:13:46] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:14:16] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:14:16] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:14:16] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:14:16] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:14:16] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:14:16] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.151s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:14:16] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:14:46] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:14:46] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:14:46] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:14:46] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:14:46] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:14:46] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.184s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:14:46] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:15:46] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:15:46] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:15:46] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:15:46] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:15:46] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:15:46] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.736s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:15:46] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:16:16] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:16:16] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:16:16] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:16:16] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:16:16] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:16:16] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.292s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:16:16] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:16:46] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:16:46] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:16:46] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:16:46] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:16:46] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:16:46] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.453s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:16:46] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:17:16] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:17:16] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:17:16] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:17:16] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:17:16] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:17:16] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.298s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:17:16] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:17:46] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:17:46] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:17:46] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:17:46] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:17:46] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:17:46] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.360s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:17:46] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:18:16] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:18:16] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:18:16] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:18:16] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:18:16] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:18:16] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.132s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:18:16] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:18:46] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:18:46] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:18:46] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:18:46] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:18:46] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:18:46] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.521s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:18:47] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:19:16] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:19:16] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:19:16] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:19:16] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:19:16] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:19:16] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.156s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:19:16] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:19:46] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:19:46] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:19:46] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:19:46] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:19:46] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:19:46] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.274s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:19:46] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:20:16] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:20:16] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:20:16] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:20:16] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:20:16] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:20:16] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.350s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:20:16] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:20:46] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:20:46] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:20:46] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:20:46] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:20:46] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:20:46] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.229s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:20:46] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:21:16] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:21:16] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:21:16] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:21:16] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:21:16] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:21:16] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.314s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:21:16] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:21:46] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:21:46] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:21:46] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:21:46] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:21:46] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:21:46] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.402s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:21:47] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:22:16] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:22:16] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:22:16] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:22:16] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:22:16] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:22:16] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.280s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:22:16] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:22:46] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:22:46] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:22:46] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:22:46] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:22:46] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:22:46] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.567s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:22:47] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:23:16] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:23:16] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:23:16] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:23:16] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:23:16] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:23:16] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.240s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:23:16] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:23:46] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:23:46] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:23:46] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:23:46] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:23:46] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:23:46] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.322s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:23:47] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:24:16] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:24:16] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:24:16] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:24:16] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:24:16] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:24:16] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.407s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:24:17] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:24:46] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:24:46] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:24:46] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:24:46] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:24:46] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:24:46] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.285s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:24:47] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:25:16] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:25:16] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:25:16] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:25:16] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:25:16] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:25:16] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:2.220s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:25:19] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:25:46] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:25:46] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:25:46] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:25:46] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:25:46] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:25:46] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.123s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:25:46] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:26:16] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:26:16] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:26:16] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:26:16] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:26:16] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:26:16] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.307s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:26:17] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:26:46] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:26:46] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:26:46] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:26:46] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:26:46] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:26:46] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.357s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:26:47] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:27:16] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:27:16] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:27:16] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:27:16] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:27:16] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:27:16] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.238s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:27:17] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:27:46] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:27:46] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:27:46] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:27:46] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:27:46] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:27:46] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.325s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:27:47] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:28:17] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:28:17] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:28:17] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:28:17] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:28:17] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:28:17] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.251s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:28:17] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:28:47] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:28:47] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:28:47] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:28:47] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:28:47] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:28:47] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.247s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:28:47] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:29:17] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:29:17] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:29:17] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:29:17] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:29:17] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:29:17] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.129s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:29:17] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:29:47] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:29:47] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:29:47] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:29:47] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:29:47] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:29:47] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.517s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:29:47] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:30:17] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:30:17] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:30:17] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:30:17] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:30:17] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:30:17] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.192s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:30:17] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:30:47] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:30:47] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:30:47] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:30:47] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:30:47] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:30:47] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.090s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:30:47] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:31:17] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:31:17] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:31:17] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:31:17] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:31:17] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:31:17] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.059s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:31:17] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:31:47] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:31:47] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:31:47] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:31:47] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:31:47] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:31:47] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:2.629s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:31:49] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:32:17] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:32:17] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:32:17] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:32:17] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:32:17] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:32:17] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.122s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:32:17] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:32:47] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:32:47] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:32:47] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:32:47] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:32:47] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:32:47] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.202s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:32:47] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:33:17] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:33:17] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:33:17] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:33:17] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:33:17] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:33:17] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.283s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:33:17] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:33:47] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:33:47] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:33:47] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:33:47] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:33:47] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:33:47] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.158s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:33:47] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:34:17] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:34:17] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:34:17] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:34:17] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:34:17] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:34:17] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.239s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:34:17] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:34:47] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:34:47] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:34:47] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:34:47] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:34:47] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:34:47] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.117s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:34:47] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:35:17] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:35:17] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:35:17] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:35:17] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:35:17] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:35:17] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.402s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:35:17] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:35:47] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:35:47] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:35:47] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:35:47] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:35:47] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:35:47] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.282s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:35:47] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:36:17] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:36:17] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:36:17] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:36:17] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:36:17] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:36:17] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.361s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:36:17] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:36:47] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:36:47] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:36:47] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:36:47] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:36:47] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:36:47] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.233s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:36:47] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:37:17] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:37:17] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:37:17] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:37:17] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:37:17] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:37:17] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.313s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:37:17] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:37:47] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:37:47] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:37:47] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:37:47] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:37:47] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:37:47] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.391s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:37:47] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:38:17] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:38:17] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:38:17] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:38:17] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:38:17] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:38:17] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.788s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:38:18] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:38:47] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:38:47] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:38:47] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:38:47] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:38:47] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:38:47] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.340s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:38:47] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:39:17] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:39:17] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:39:17] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:39:17] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:39:17] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:39:17] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.217s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:39:17] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:39:47] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:39:47] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:39:47] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:39:47] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:39:47] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:39:47] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.290s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:39:47] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:40:17] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:40:17] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:40:17] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:40:17] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:40:17] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:40:17] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.373s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:40:18] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:40:47] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:40:47] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:40:47] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:40:47] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:40:47] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:40:47] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.242s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:40:47] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:41:17] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:41:17] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:41:17] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:41:17] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:41:17] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:41:17] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.323s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:41:18] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:41:47] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:41:47] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:41:47] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:41:47] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:41:47] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:41:47] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.404s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:41:48] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:42:17] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:42:17] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:42:17] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:42:17] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:42:17] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:42:17] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.279s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:42:18] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:42:47] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:42:47] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:42:47] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:42:47] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:42:47] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:42:47] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.153s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:42:47] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:43:17] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:43:17] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:43:17] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:43:17] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:43:17] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:43:17] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.407s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:43:18] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:43:47] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:43:47] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:43:47] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:43:47] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:43:47] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:43:47] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.281s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:43:48] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:44:17] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:44:17] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:44:17] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:44:17] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:44:17] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:44:17] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.185s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:44:18] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:44:47] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:44:47] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:44:47] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:44:47] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:44:47] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:44:47] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.236s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:44:48] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:45:18] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:45:18] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:45:18] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:45:18] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:45:18] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:45:18] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.313s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:45:18] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:45:48] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:45:48] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:45:48] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:45:48] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:45:48] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:45:48] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.398s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:45:48] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:46:18] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:46:18] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:46:18] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:46:18] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:46:18] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:46:18] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.270s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:46:18] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:46:48] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:46:48] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:46:48] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:46:48] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:46:48] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:46:48] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.349s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:46:48] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:47:18] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:47:18] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:47:18] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:47:18] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:47:18] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:47:18] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.226s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 17:47:18] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:22] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:51] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:51] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:51] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:51] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:51] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:51] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:N/A duration:30.031s]
WARNING:elastic_transport.node_pool:Node <Urllib3HttpNode(http://139.28.47.17:9908)> has failed for 1 times in a row, putting on 1 second timeout
WARNING:elastic_transport.transport:Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connection.py", line 571, in getresponse
    httplib_response = super().getresponse()
  File "/usr/lib/python3.14/http/client.py", line 1450, in getresponse
    response.begin()
    ~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.14/http/client.py", line 336, in begin
    version, status, reason = self._read_status()
                              ~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.14/http/client.py", line 297, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/usr/lib/python3.14/socket.py", line 725, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
TimeoutError: timed out

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
        method,
    ...<4 lines>...
        **kw,  # type: ignore[arg-type]
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/util/retry.py", line 465, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 536, in _make_request
    self._raise_timeout(err=e, url=url, timeout_value=read_timeout)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 367, in _raise_timeout
    raise ReadTimeoutError(
        self, url, f"Read timed out. (read timeout={timeout_value})"
    ) from err
urllib3.exceptions.ReadTimeoutError: HTTPConnectionPool(host='139.28.47.17', port=9908): Read timed out. (read timeout=30)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/elastic_transport/_transport.py", line 344, in perform_request
    resp = node.perform_request(
        method,
    ...<3 lines>...
        request_timeout=request_timeout,
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionTimeout: Connection timeout caused by: ReadTimeoutError(HTTPConnectionPool(host='139.28.47.17', port=9908): Read timed out. (read timeout=30))
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.220s]
WARNING:elastic_transport.node_pool:Node <Urllib3HttpNode(http://139.28.47.17:9908)> has been marked alive after a successful request
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:52] "GET /api/stats HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.204s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:53] "GET /api/stats HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.204s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:53] "GET /api/stats HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.203s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:53] "GET /api/stats HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.610s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:54] "GET /api/stats HTTP/1.1" 200 -
INFO:elastic_transport.node_pool:Resurrected node <Urllib3HttpNode(http://139.28.47.17:9908)> (force=False)
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.202s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:54] "GET /api/stats HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.201s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:54] "GET /api/stats HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.205s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:54] "GET /api/stats HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.408s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:54] "GET /api/stats HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.198s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:55] "GET /api/stats HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.199s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:55] "GET /api/stats HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.402s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:55] "GET /api/stats HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.404s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:55] "GET /api/stats HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.402s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:24:55] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:25:22] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:25:22] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:25:22] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:25:22] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:25:22] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:25:22] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.313s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:25:23] "GET /api/stats HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:N/A duration:30.100s]
WARNING:elastic_transport.node_pool:Node <Urllib3HttpNode(http://139.28.47.17:9908)> has failed for 1 times in a row, putting on 1 second timeout
WARNING:elastic_transport.transport:Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connection.py", line 571, in getresponse
    httplib_response = super().getresponse()
  File "/usr/lib/python3.14/http/client.py", line 1450, in getresponse
    response.begin()
    ~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.14/http/client.py", line 336, in begin
    version, status, reason = self._read_status()
                              ~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.14/http/client.py", line 297, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/usr/lib/python3.14/socket.py", line 725, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
TimeoutError: timed out

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
        method,
    ...<4 lines>...
        **kw,  # type: ignore[arg-type]
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/util/retry.py", line 465, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 536, in _make_request
    self._raise_timeout(err=e, url=url, timeout_value=read_timeout)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 367, in _raise_timeout
    raise ReadTimeoutError(
        self, url, f"Read timed out. (read timeout={timeout_value})"
    ) from err
urllib3.exceptions.ReadTimeoutError: HTTPConnectionPool(host='139.28.47.17', port=9908): Read timed out. (read timeout=30)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/elastic_transport/_transport.py", line 344, in perform_request
    resp = node.perform_request(
        method,
    ...<3 lines>...
        request_timeout=request_timeout,
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionTimeout: Connection timeout caused by: ReadTimeoutError(HTTPConnectionPool(host='139.28.47.17', port=9908): Read timed out. (read timeout=30))
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.098s]
WARNING:elastic_transport.node_pool:Node <Urllib3HttpNode(http://139.28.47.17:9908)> has been marked alive after a successful request
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:25:23] "GET /api/stats HTTP/1.1" 200 -
INFO:elastic_transport.node_pool:Resurrected node <Urllib3HttpNode(http://139.28.47.17:9908)> (force=False)
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:25:51] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:25:51] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:25:51] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:25:51] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:25:51] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:25:51] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.063s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:25:51] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:26:21] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:26:21] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:26:21] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:26:21] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:26:21] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:26:21] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.088s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:26:22] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:26:51] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:26:51] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:26:51] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:26:51] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:26:51] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:26:51] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.383s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:26:52] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:27:22] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:27:22] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:27:22] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:27:22] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:27:22] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:27:22] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.266s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:27:22] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:27:52] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:27:52] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:27:52] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:27:52] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:27:52] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:27:52] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:2.614s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:27:54] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:28:22] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:28:22] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:28:22] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:28:22] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:28:22] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:28:22] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.440s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:28:22] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:28:52] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:28:52] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:28:52] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:28:52] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:28:52] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:28:52] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.326s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:28:52] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:29:22] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:29:22] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:29:22] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:29:22] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:29:22] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:29:22] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.208s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:29:22] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:29:52] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:29:52] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:29:52] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:29:52] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:29:52] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:29:52] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:0.297s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:29:52] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:30:22] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:30:22] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:30:22] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:30:22] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:30:22] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:30:22] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:6.903s]
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:30:29] "GET /api/stats HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:30:52] "GET /api/rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:30:52] "GET /api/alerts HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:30:52] "GET /api/charts/timeline HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:30:52] "GET /api/charts/top-rules HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:30:52] "GET /api/charts/severity HTTP/1.1" 200 -
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:30:52] "GET /api/charts/top-sources HTTP/1.1" 200 -
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:N/A duration:30.100s]
WARNING:elastic_transport.node_pool:Node <Urllib3HttpNode(http://139.28.47.17:9908)> has failed for 1 times in a row, putting on 1 second timeout
WARNING:elastic_transport.transport:Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connection.py", line 571, in getresponse
    httplib_response = super().getresponse()
  File "/usr/lib/python3.14/http/client.py", line 1450, in getresponse
    response.begin()
    ~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.14/http/client.py", line 336, in begin
    version, status, reason = self._read_status()
                              ~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.14/http/client.py", line 297, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/usr/lib/python3.14/socket.py", line 725, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
TimeoutError: timed out

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
        method,
    ...<4 lines>...
        **kw,  # type: ignore[arg-type]
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/util/retry.py", line 465, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 536, in _make_request
    self._raise_timeout(err=e, url=url, timeout_value=read_timeout)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/urllib3/connectionpool.py", line 367, in _raise_timeout
    raise ReadTimeoutError(
        self, url, f"Read timed out. (read timeout={timeout_value})"
    ) from err
urllib3.exceptions.ReadTimeoutError: HTTPConnectionPool(host='139.28.47.17', port=9908): Read timed out. (read timeout=30)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/elastic_transport/_transport.py", line 344, in perform_request
    resp = node.perform_request(
        method,
    ...<3 lines>...
        request_timeout=request_timeout,
    )
  File "/home/mikro/All-ESQL-standart-rules/venv/lib/python3.14/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionTimeout: Connection timeout caused by: ReadTimeoutError(HTTPConnectionPool(host='139.28.47.17', port=9908): Read timed out. (read timeout=30))
INFO:elastic_transport.transport:HEAD http://139.28.47.17:9908/ [status:200 duration:2.089s]
WARNING:elastic_transport.node_pool:Node <Urllib3HttpNode(http://139.28.47.17:9908)> has been marked alive after a successful request
INFO:werkzeug:10.174.195.238 - - [02/Feb/2026 20:31:24] "GET /api/stats HTTP/1.1" 200 -
